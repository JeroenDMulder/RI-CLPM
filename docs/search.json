[
  {
    "objectID": "faq.html",
    "href": "faq.html",
    "title": "Frequently Asked Questions",
    "section": "",
    "text": "Below you can find a list of frequently asked questions, organized by topic, that reach us via email. Click the question to see our response.\n\nIncluding covariates\n\n\n\n\n\n\nHow do I include time-varying covariates with the RI-CLPM?\n\n\n\n\n\nThe inclusion of a single additional time-varying covariate (TVC) \\(Z\\) is commonly done similarly to how “regular” \\(X\\) and \\(Y\\) outcomes are treated in the RI-CLPM; hence, rather than a bivariate RI-CLPM you would specify a tri- (or more-variate) RI-CLPM. As such, you decompose the TVC in within-components (e.g. \\(wz1\\), \\(wz2\\), etc.) and a between-component (a random intercept for \\(Z\\); e.g. \\(RI_{z}\\)) and model these components separately. However, if you want to control for many TVCs, this approach can quickly become unwieldly, leading to large statistical models that rely on many causal and statistical assumptions, and that can be hard to estimate. For researchers who want to adjust for a larger set of time-varying covariates, it might be worthwhile to consider alternative modeling approaches that have been proposed in the causal inference literature, such as those based on propensity scores.\n\n\n\n\n\n\n\n\n\nHow do I include time-invariant covariates with the RI-CLPM?\n\n\n\n\n\nFor time-invariant covariates, you can differentiate between those that have a stable effect across time, and those that have a time-varying effect across time. Take gender for example. When studying adolescents across years, you might expect that gender plays an increasingly important role for the \\(X\\) and \\(Y\\) variables as children reach puberty. In this case, gender can be considered a time-invariant covariate that has a time-varying effect. For these covariates, it might be best to include these as predictors of the observed \\(X\\) and \\(Y\\) in order to control for their potentially confounding effect—however, research on this topic is still very much ongoing, see for example, Murayama and Gfrörer (2022). However, when you are studying a much shorter time span—for example, studying adolescents across a couple of weeks, or adults—then gender might be considered to be a time-invariant covariate with a stable effect on \\(X\\) and \\(Y\\). For this type of covariate, the RI-CLPM controls by default through the inclusion of the random intercept factor. Usami (2021) covers this in detail.\n\n\n\n\n\n\n\n\n\nIs it possible to run an RI-CLPM with three (or more) outcomes?\n\n\n\n\n\nYes, it is statistically possible to run a “trivariate” RI-CLPM and empirical researchers have done so, see for example Van Lissa et al. (2019), Flouri et al. (2019), and Hygen et al. (2022). We don’t provide model code here for this mode, but extension to a trivariate RI-CLPM should be relatively straight forwards. That is, all variables should be decomposed into between- (random intercepts) and within-components, and relevant lagged effects, as well as (residual) variances and covariances, should be included in the model.\n\n\n\n\n\nModeration and mediation\n\n\n\n\n\n\nIs it possible to specify a moderator within the RI-CLPM?\n\n\n\n\n\nThere are various approaches for studying moderation within the RI-CLPM, depending on the measurement level of the moderator variable. Moderation by a time-invariant, categorical variable can be investigated using a multiple group RI-CLPM, as described in Extension 2 of Mulder and Hamaker (2021). Moderation by a time-varying, continuous variable can be investigating by creating latent interactions of the moderator \\(\\times\\) within-components, or the moderator \\(\\times\\) random intercept factor(s). See Ozkok et al. (2022) and Speyer et al. (2023) for detailed information on how to this.\nDue to the high computational burden that the inclusion of a continuous time-varying moderator places on the estimation, Ozkok et al. (2022) make use of a Bayesian estimator. Their supplemental materials, including the Mplus model syntax, can be found at https://journals.sagepub.com/doi/suppl/10.1177/10944281211043733. They note that currently only Mplus supports the use of latent interactions as used here.\n\n\n\n\n\n\n\n\n\nIs it possible to test for mediation effects in the RI-CLPM?\n\n\n\n\n\nWhile it is statistically possible to include a third time-varying covariate into the RI-CLPM (which can be used to investigate mediation at the within-person level), there are multiple theoretical concerns that complicate the interpretation of estimates related to mediation. Researchers are strongly advised to give these concerns due consideration when interested in studying mediation using the RI-CLPM.\nFirst, there are multiple options for defining a direct effect, and it might not be straightforward which option is appropriate for a particular research question. That is, there are multiple paths not through the mediator variable \\(M\\) that represent an effect of \\(X\\) on a \\(Y\\) at a later occasion. For example, is the direct effect only the lag-2 effect \\(X_{1} \\rightarrow Y_{3}\\), or is the combination of the effects \\(X_{1} \\rightarrow Y_{2} \\rightarrow Y_{3}\\), \\(X_{1} \\rightarrow X_{2} \\rightarrow Y_{3}\\) and \\(X_{1} \\rightarrow Y_{3}\\)?\nSecond, mediation analysis is often causal in nature, as you want to know the mechanism by which a variable \\(X\\) influences another variable \\(Y\\). For a causal interpretation of the statistical estimates, you need to carefully evaluate the causal identification assumptions (i.e., exchangeability, consistency, and positivity), and rely on the statistical assumptions that implied by the RI-CLPM (e.g., linearity, multivariate normality). Evaluation of these assumptions can be quite challenging, and you might find that your targeted causal mediation effect is not identified. Interested readers are referred to Keele (2015) for a short introduction to these assumptions in the context of mediation analysis.\n\n\n\n\n\nStandardization\n\n\n\n\n\n\nHow should I interpret the standardized cross-lagged and autoregressive parameters?\n\n\n\n\n\nIn the RI-CLPM, the standardized effects are reflective/representative of how much within-person variance in \\(y_{t}\\) is uniquely explained (i.e., not also explained by other predictors) by the predictor \\(x_{t-1}\\). Please note that this does not imply that one can make a one-on-one comparison with the percentage of explained variance. However, the standardized effects can be used to compare which effect is relatively stronger (Schuurman et al. 2016).\n\n\n\n\n\n\n\n\n\nHow do standardized cross-lagged and autoregressive parameters compare to explained variance?\n\n\n\n\n\nThe standardized lagged parameters are not equal to the (squared) semipartial correlation. Only under special circumstances, a standardized regression coefficient is equal to the pairwise correlation between the outcome and predictor, and the square of the standardized regression coefficient would then be the explained variance (\\(R^{2}\\)). This only applies in the case of (a) a simple regression, where there is only one predictor in the model, or (b) a multiple regression where the predictors are independent of each other. In the RI-CLPM, however, the multiple predictors are not independent of each other, and therefore the standardized regression coefficients are not equal to the pairwise correlation, (semi)partial correlation, or the unique explained variance.\nHowever, the standardized coefficient is closely related to the semipartial correlation, as demonstrated in footnote 3 of Schuurman et al. (2016). The standardized coefficient is expressed in terms of pairwise correlations in the first equation there, and the semipartial correlation expressed in terms of pairwise correlations in the second equation. They are very similar, but there is a subtle difference in the denominator.\nSo, the semipartial correlation and standardized coefficient are not equal, but we can see that if the semipartical correlation for one predictor is larger than for another predictor, this will also be the case for the standardized coefficients of these predictors. The square of the semi-partial correlation is the unique explained variance, so we also know that the predictor with the largest standardized coefficient, will also have the largest unique explained variance.\nAnswer by dr. Noémi Schuurman.\n\n\n\n\n\n\n\n\n\nHow can I constrain the standardized parameters to be invariant over time?\n\n\n\n\n\nWhile the lagged parameters can be constrained to be invariant over time, this does not imply that the standardized parameters will be invariant over time as well. The reason for this is that a standardized parameter is a function of the unstandardized parameter, and of the standard deviations of the predictor and the outcome variable, \\(\\beta_{standardized} = \\frac{SD(x)}{SD(y)}\\beta\\). Since the variances of the within-components themselves are not constrained to be invariant over time, the standard deviations of the predictor and the outcome variable for the lagged effects can vary over time. Therefore, the standardized lagged effects can vary even while the unstandardized lagged effects are constrained to be equal over time.\nTo make the standardized lagged parameters time invariant, the within-person components need to have a variance of 1 at every occasion. In that case, the lagged parameters are already the standardized lagged parameters, and it becomes possible to impose time-constraints on them. At the first wave, the variances of the within-components can be set directly as these variables are exogenous. However, for \\(t &gt; 1\\), the variances of the within-components are functions of the lagged parameters, and the covariance between the lagged predictors. Specifically, using the path tracing rules (Wright 1934) and assuming the variance of lagged within-component is in fact 1, the variance of \\(wx_{it}\\) can be expressed as \\[Var[wx_{it}] = \\alpha^{2}_{t} + \\gamma^{2}_{t} + 2 \\alpha_{t} \\gamma_{t} Cov[wx_{i,t-1}, wy_{i,t-1}] + Var[u_{it}]\\] where \\(\\alpha_{t}\\) is the autoregressive effect of \\(wx\\), \\(\\gamma{t}\\) is the cross-lagged effect from \\(wy_{i,t-1}\\) to \\(wx_{it}\\), and \\(u_{Xit}\\) is the residual of \\(wx\\). So, the variance of \\(wx_{it}\\) itself can be set to 1 by imposing a constrain on the residual variance \\(Var[u_{it}]\\), that is \\[Var[u_{it}] = 1 - (\\alpha^{2}_{t} + \\gamma^{2}_{t} + 2 \\alpha_{t} \\gamma_{t} Cov[wx_{i,t-1}, wy_{i,t-1}])\\].\nThe final quantity that we need to compute is the covariance (here also the correlation) between the two lagged within-components, \\(Cov[wx_{i,t-1}, wy_{i,t-1}]\\). At wave 1, this is simply a model parameter (i.e., the covariance between the within-components can be estimated directly). For \\(t &gt; 1\\), this covariance is a function of the lagged coefficients, the variances of the lagged within-components, and the covariance between the residuals at the preceding occasion. Again, using the path tracing rules and assuming the variances of lagged within-components are in fact 1, it can be expressed as \\[Cov[wx_{it}, wy_{it}] = \\alpha_{t} \\gamma_{t} + \\beta_{t} \\delta_{t} + \\alpha_{t} \\delta_{t} Cov[wx_{i,t-1}, wy_{i,t-1}] + \\beta_{t} \\gamma_{t} Cov[wx_{i,t-1}, wy_{i,t-1}] + Cov[u_{Xit}, u_{Yit}]\\] where \\(\\delta_{t}\\) is the autoregressive effect of \\(wy\\), \\(\\beta_{t}\\) is the cross-lagged effect from \\(wx_{i,t-1}\\) to \\(wy_{it}\\), and \\(u_{Yit}\\) is the residual of \\(wy\\).\nTo impose such constraints in Mplus or lavaan, we thus first need to compute the covariance (i.e., correlation) between the within-components at each occasion. Then, these can be used to constrain the residual variances of the within-components in such a way that the variances of the within-person components equal 1. Syntax has been added to this website to specify this model in Mplus and lavaan. Note that in this model, the factor loadings that link the observed variables to the within-components are not fixed to 1 as is usually done, but they are estimated freely.\nAnswer by prof. dr. Ellen L. Hamaker.\n\n\n\n\n\nNon-continuous outcomes\n\n\n\n\n\n\nCan I run the RI-CLPM with binary/categorical/count outcomes?\n\n\n\n\n\nWith Mplus version 8.7 and later, it is possible to estimate the RI-CLPM for binary and ordinal variables as well (Asparouhov and Muthén 2021). Compared to the RI-CLPM for continuous variables, there are two important differences:\n\nA Bayesian estimator or WLSMV estimator (with theta parametrization) is needed. This can be specified by specifying either ESTIMATOR = BAYES; or ESTIMATOR = WLSMV; in the ANALYSIS command, as well as PARAM = THETA; for the WLSMV estimator.\nThe variances and residual variances of the within-components are fixed to 1, as is standard when using the probit-model in Mplus for categorical data analysis. These can be freely estimated in principle, but generally require larger sample sizes, and are prone to empirical non-identification. Several strategies for (partly) freeing up these variances are discussed in Asparouhov and Muthén (2021).\n\nThe interested reader is referred to Asparouhov and Muthén (2021) for more details.\n\n\n\n\n\nPower\n\n\n\n\n\n\nHow do I perform a power analysis for the RI-CLPM?\n\n\n\n\n\npowRICLPM is an R-package that performs a power analysis for the RI-CLPM in a simple and user-friendly way. It implements the strategy as proposed by Mulder (2023), and includes various extensions such as the inclusion of measurement error (leading to the stable trait autoregressive trait state model by Kenny and Zautra (2001), and multiple constraints over time. powRICLPM is available from the Comprehensive R Archive Network (CRAN). More information can be found at https://jeroendmulder.github.io/powRICLPM/.\n\n\n\n\n\nCLPM v. RICLPM\n\n\n\n\n\n\nWhy are the autoregressive effects in the RI-CLPM typically smaller than in the CLPM?\n\n\n\n\n\nThe autoregressive effects in the CLPM and the RI-CLPM capture two distinct phenomena. In the traditional CLPM, the autoregressive effects capture both within- and between-unit effects, and it can be interpreted as rank-order stability. In the RI-CLPM, the stable, between-person variance is separated from the within-person variance such that the autoregressive effects only capture within-person carry-over. In other words, in the RI-CLPM the autoregressive effects are typically smaller because the stable, trait-like stability is not captured anymore by the autoregressive effects (as in the CLPM), but by the random intercepts.\n\n\n\n\n\n\n\n\n\nIs it a bad sign that the standard errors are typically larger in the RI-CLPM than in the CLPM?\n\n\n\n\n\nNo, this is to be expected because the RI-CLPM is a more complex model than the CLPM. Therefore, the point estimates are less certain, but this does not imply that the estimates are biased and the model does not give us any insight in the underlying mechanism under study. In contrast, the RI-CLPM is likely less biased than results from the CLPM because the RI-CLM accounts for stable, unobserved factors that create lasting between-person differences, which can create spurious empirical relationships between the constructs under investigation when not properly accounted for.\n\n\n\n\n\nGrowth and development\n\n\n\n\n\n\nHow can the RI-CLPM incorporate growth over time?\n\n\n\n\n\nThe RI-CLPM estimates grand means at each time point. If these are constrained to be time-invariant, this would imply that on average there is no change. However, if these constraints cannot be imposed on the model, this means that on average there is some kind of change (e.g., growth, decline, U-shape, sudden jump between two waves, etc.). In this case, the model implies that every person is modeled to have the exact same underlying trend over time, but at a constant deviation from the average trend (as captured by the random intercept factor). Hence, instead of talking about constant means over time, one would have to talk about constant deviations from an average trend.\nIn the latent growth curve model (LGCM) and its extension, the latent curve model with structured residuals (LCM-SR), it is assumed that individual have the same kind of trend (e.g., a linear or quadratic trend), but there can be individual differences in the parameters of this trend; as a result, the differences between individuals change over time (i.e., they may increase or decrease). When the variance of the slope components (i.e., the slope factor of both \\(X\\) and \\(Y\\) in the bivariate case) is fixed to zero, the LGCM and LCS-SR become special cases of the RI-CLPM; if the grand means in the RI-CLPM are fixed to be invariant over time, then this is a special case of the LCM-SR (Usami, Murayama, and Hamaker 2019).\n\n\n\n\n\nResponse to Orth et al. (2021)\nLately, we have received numerous questions about statements regarding the use and appropriateness of the CLPM and RI-CLPM in “Testing Prospective Effects in Longitudinal Research: Comparing Seven Competing Cross-Lagged Models” by Orth et al. (2021). In our opinion, numerous conclusions herein are incorrect. Below we elaborate on some of their most prominent conclusions. For another reaction to this article, see https://replicationindex.com/2020/08/22/cross-lagged.\n\n\n\n\n\n\nThe RI-CLPM is not suited for studying prospective between-person effects, whereas the CLPM is.\n\n\n\n\n\nOn page 1026, Orth et al. (2021) state that the RI-CLPM does not allow for the testing of prospective between-person effects because “(…) the random intercept factors provide information only about correlational associations between the constructs (…), but not about time-lagged (i.e, longitudinal) and directional between-person effects.” It is true that the RI-CLPM separates stable, between-person differences from temporal, within-person fluctuations. Only the latter allow one to look at prospective effects over time, while the stable between-person differences have no particular time-order.\nThe reasoning that Orth et al. (2021) seem to follow is this: If one is interested in trait-changes, we should not separate the stable trait components from the temporary fluctuations, as the first does not allow for the study of prospective effects and are not of interest because they are entirely stable, while the latter only contain state-like fluctuations that are less interesting to researchers who want to study in trait-changes. Orth et al. (2021) seem to consider both components separately not to be of interest, but nevertheless argue that a blend of both components is of key interest. We disagree with this reasoning.\nResearchers who want to use prospective effects to study certain psychological processes, should make sure that their measurements are obtained at the time scale at which they believe the process of interest operates. If the trait-changes of interest are assumed to take place from one year to the next, then measuring yearly over several years should capture the fluctuations of interest within persons over the time span covered by the study. If trait-changes are assumed to take place at a less fine time scale, such as from decade to decade, this implies researchers should obtain data measured once per decade, for several decades.\nEven if the stable, between-person differences are not of interest, these nevertheless need to be separated from the within-person fluctuations. The stable mean differences between persons are often referred to as trait differences, but may also be conceptualized as resulting from stable confounders, such as stable genetic and environmental factors that affect our measurements.\nIn sum, the focus should be on how the constructs are measured, specifically at what time scale they are measured. By definition, the random intercepts in the RI-CLPM capture variance that is stable over the duration of the study, which is why—from a data analytical perspective—these are referred to as traits. What remains is variance within persons over time, which is why—again from a data analytical perspective—this is referred to as state-like. These trait-like between-person differences and state-like, within-person fluctuations need not coincide perfectly with the trait-state distinction made by substantive researchers. Nevertheless, it is essential to separate these two sources, regardless of what they are called.\n\n\n\n\n\n\n\n\n\nThe RI-CLPM is better suited for short-term studies because it cannot detect sustained prospective effects.\n\n\n\n\n\nThe characterization of the lagged effects as short- or long-term depends on the time scale at which the measurements are made. When using annual data, lagged effects capture the fluctuation from year to year; when dealing with data that were obtained every decade, the within-person fluctuations will concern the changes from decade to decade. It is all relative to how the data were measured, and even when we are focusing on trait changes by measuring people once every 10 years, for say 40 years, there will still be stable between-person differences between individuals that need to be controlled for.\nHence, the need to decompose the observations into a stable between-person component and temporal within-person components is independent of the time scale at which measurements were obtained.\n\n\n\n\n\n\n\n\n\nThere should be a match between the type of research question asked and the model used: The CLPM is for the analysis of between-person prospective effects whereas the RI-CLPM should be used for within-person prospective effects.\n\n\n\n\n\nWe agree with the authors in so far that there should be a match between the research question and the statistical model used. However, the critical distinction here is not whether one is interested in within-person or between-person prospective effects (as argued above, the RI-CLPM can capture trait-changes depending on the time scale at which measurements are gathered). Rather, we should distinguish between descriptive, predictive, and causal research questions (Hamaker, Mulder, and Van IJzendoorn 2020). The CLPM is suitable for predictive research questions: e.g., “Who is at risk for heightened \\(X\\)?” and “Who should get an intervention to reduce \\(Y\\)?”. However, for answering causal research questions, other models should be used, because the CLPM does not control for stable, between-person difference. This is problematic as failing to properly account for such confounding effects can lead to finding spurious lagged effects, a failure to find true relationships, or more generally, biased estimates (Hamaker, Kuiper, and Grasman 2015).\n\n\n\n\n\n\n\n\n\nThe parameters from the CLPM tend to have smaller standard errors than the parameters from the RI-CLPM; hence, the results from the CLPM are easier to replicate, which may be a reason to prefer this model.\n\n\n\n\n\nOn page 1028, Orth et al. (2021) state that “For the CLPM, the structural coefficients were much more consistent compared to the RI-CLPM, both across and within samples, which is important with regard to replicability of research findings (Asendorf et al., 2013). Even if theoretical consideration have priority over replicability in model selection, replicability of estimates is—other things being equal—an important criterion of the quality of statistical models.”\nWhen the goal is prediction, this may indeed be an important consideration. However, when the goal is to gain insight in the underlying mechanism, we should not prefer a model simply based on its ability to replicate results: Replicating biased results is only giving us false confidence in erroneous conclusions.\nInstead, we should consider which model seems more reasonable (e.g., do we believe there may be unobserved, stable confounding that plays a role in our measurements?), and which model provides a better description of the data (e.g., comparing competing models through the use of the chi-square difference test, or information criteria).\nThe larger standard errors associated with the RI-CLPM imply that if we want to have the higher precision and/or increase replicability, we need to obtain data from larger samples and/or at more waves.\n\n\n\n\n\n\n\n\nReferences\n\nAsparouhov, Tihomir, and Bengt Muthén. 2021. “Residual Structural Equation Models.” http://statmodel.com/download/Asparouhov_Muthen_2021a.pdf.\n\n\nFlouri, Eirini, Efstathios Papachristou, Emily Midouhas, George B. Ploubidis, Glyn Lewis, and Heather Joshi. 2019. “Developmental Cascades of Internalising Symptoms, Externalising Problems and Cognitive Ability from Early Childhood to Middle Adolescence.” European Psychiatry 57 (April): 61–69. https://doi.org/10.1016/j.eurpsy.2018.12.005.\n\n\nHamaker, Ellen L., Rebecca M. Kuiper, and Raoul P. P. P. Grasman. 2015. “A Critique of the Cross-Lagged Panel Model.” Psychological Methods 20 (1): 102–16. https://doi.org/10.1037/a0038889.\n\n\nHamaker, Ellen L., Jeroen D. Mulder, and Marinus H. Van IJzendoorn. 2020. “Description, Prediction and Causation: Methodological Challenges of Studying Child and Adolescent Development.” Developmental Cognitive Neuroscience 46 (December): 100867. https://doi.org/10.1016/j.dcn.2020.100867.\n\n\nHygen, Beate W., Jay Belsky, Frode Stenseng, Silje Steinsbekk, Lars Wichstrøm, and Vera Skalicka. 2022. “Longitudinal Relations Between Gaming, Physical Activity, and Athletic Self-Esteem.” Computers in Human Behavior 132 (July): 107252. https://doi.org/10.1016/j.chb.2022.107252.\n\n\nKeele, Luke. 2015. “Causal Mediation Analysis: Warning! Assumptions Ahead.” American Journal of Evaluation 36 (4): 500–513. https://doi.org/10.1177/1098214015594689.\n\n\nKenny, David A., and Alex Zautra. 2001. “Trait–State Models for Longitudinal Data.” In New Methods for the Analysis of Change., edited by Linda M. Collins and Aline G. Sayer, 243–63. Washington: American Psychological Association. https://doi.org/10.1037/10409-008.\n\n\nMulder, Jeroen D. 2023. “Power Analysis for the Random Intercept Cross-Lagged Panel Model Using the powRICLPM R-Package.” Structural Equation Modeling: A Multidisciplinary Journal 30 (4): 645–58. https://doi.org/10.1080/10705511.2022.2122467.\n\n\nMulder, Jeroen D., and Ellen L. Hamaker. 2021. “Three Extensions of the Random Intercept Cross-Lagged Panel Model.” Structural Equation Modeling: A Multidisciplinary Journal 28 (4): 638–48. https://doi.org/10.1080/10705511.2020.1784738.\n\n\nMurayama, Kou, and Thomas Gfrörer. 2022. “Thinking Clearly about Time-Invariant Confounders in Cross-Lagged Panel Models: A Guide for Choosing a Statistical Model from a Causal Inference Perspective.” PsyArXiv. https://doi.org/10.31234/osf.io/bt9xr.\n\n\nOrth, Ulrich, D. Angus Clark, M. Brent Donnellan, and Richard W. Robins. 2021. “Testing Prospective Effects in Longitudinal Research: Comparing Seven Competing Cross-Lagged Models.” Journal of Personality and Social Psychology 120 (4): 1013–34. https://doi.org/10.1037/pspp0000358.\n\n\nOzkok, Ozlem, Manuel J. Vaulont, Michael J. Zyphur, Zhen Zhang, Kristopher J. Preacher, Peter Koval, and Yixia Zheng. 2022. “Interaction Effects in Cross-Lagged Panel Models: SEM with Latent Interactions Applied to Work-Family Conflict, Job Satisfaction, and Gender.” Organizational Research Methods 25 (4): 673–715. https://doi.org/10.1177/10944281211043733.\n\n\nSchuurman, Noémi K., Emilio Ferrer, Mieke De Boer-Sonnenschein, and Ellen L. Hamaker. 2016. “How to Compare Cross-Lagged Associations in a Multilevel Autoregressive Model.” Psychological Methods 21 (2): 206–21. https://doi.org/10.1037/met0000062.\n\n\nSpeyer, Lydia Gabriela, Anastasia Ushakova, Sarah-Jayne Blakemore, Aja Louise Murray, and Rogier Kievit. 2023. “Testing for Within × Within and Between × Within Moderation Using Random Intercept Cross-Lagged Panel Models.” Structural Equation Modeling: A Multidisciplinary Journal 30 (2): 315–27. https://doi.org/10.1080/10705511.2022.2096613.\n\n\nUsami, Satoshi. 2021. “On the Differences Between General Cross-Lagged Panel Model and Random-Intercept Cross-Lagged Panel Model: Interpretation of Cross-Lagged Parameters and Model Choice.” Structural Equation Modeling: A Multidisciplinary Journal 28 (3): 331–44. https://doi.org/10.1080/10705511.2020.1821690.\n\n\nUsami, Satoshi, Kou Murayama, and Ellen L. Hamaker. 2019. “A Unified Framework of Longitudinal Models to Examine Reciprocal Relations.” Psychological Methods 24 (5): 637–57. https://doi.org/10.1037/met0000210.\n\n\nVan Lissa, Caspar J., Renske Keizer, Pol A. C. Van Lier, Wim H. J. Meeus, and Susan Branje. 2019. “The Role of Fathers’ Versus Mothers’ Parenting in Emotion-Regulation Development from Mid–Late Adolescence: Disentangling Between-Family Differences from Within-Family Effects.” Developmental Psychology 55 (2): 377–89. https://doi.org/10.1037/dev0000612.\n\n\nWright, Sewall. 1934. “The Method of Path Coefficients.” The Annals of Mathematical Statistics 5 (3): 161–215. https://doi.org/10.1214/aoms/1177732676."
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "The RI-CLPM & Extensions",
    "section": "",
    "text": "This website is a supplement to “Three Extensions of the Random Intercept Cross-Lagged Panel Model” by Mulder and Hamaker (2021). It contains Mplus syntax and lavaan code for specifying the basic RI-CLPM and the following three extensions:\n\nincluding a time-invariant predictor and outcome,\ndoing multiple group analysis, and\nusing multiple indictors for variables.\n\nUse the top menu to navigate to the Mplus syntax, lavaan code, News, or Frequently Asked Questions (FAQ). The lavaan (R) page additionally contains R code for performing the \\(\\bar{\\chi}^{2}\\)-test (chi-bar-square test), and R code for using the GORICA. The \\(\\bar{\\chi}^{2}\\)-test is used for comparing nested models where the more parsimonious model is based on constraining parameters on the bound of the parameter space (e.g., constraining a variance to 0). The GORICA is an information criterion that can be used for causal dominance hypothesis evaluation. The News tab documents important updates and additions to the Mplus syntax, lavaan model syntax, or the FAQ on this website.\n\nData\nYou can find simulated example data sets (1189 units, 5 repeated-measures) on GitHub to get hands-on experience with this modeling approach. The example data are motivated by Narmandakh et al. (2020), who obtained 5 waves of data from 1189 adolescents on their sleep problems and anxiety over 15 years.\n\n\n\n\n\nReferences\n\nMulder, Jeroen D., and Ellen L. Hamaker. 2021. “Three Extensions of the Random Intercept Cross-Lagged Panel Model.” Structural Equation Modeling: A Multidisciplinary Journal 28 (4): 638–48. https://doi.org/10.1080/10705511.2020.1784738.\n\n\nNarmandakh, Altanzul, Annelieke M. Roest, Peter de Jonge, and Albertine J. Oldehinkel. 2020. “The bidirectional association between sleep problems and anxiety symptoms in adolescents: A TRAILS report.” Sleep Medicine 67 (March): 39–46. https://doi.org/10.1016/j.sleep.2019.10.018."
  },
  {
    "objectID": "lavaan.html",
    "href": "lavaan.html",
    "title": "Using lavaan",
    "section": "",
    "text": "Below you can find the code for installing and loading the required package lavaan (Rosseel 2012), as well as for reading in the example data. You can specify the path to the data yourself, or through a menu by using the file.choose()-function. You can download the simulated example datasets here.\n\n# If necessary, install the 'lavaan' package. \n# install.packages('lavaan', dependencies = T)\n\n# Load the required packages.\nrequire(lavaan) \n\n# Load in the data\n## Traditional RI-CLPM\ndat &lt;- read.table(\"/Users/jeroenmulder/Git/RICLPM/data/RICLPM.dat\", \n                  col.names = c(\n                    \"x1\", \"x2\", \"x3\", \"x4\", \"x5\", \n                    \"y1\", \"y2\", \"y3\", \"y4\", \"y5\")\n                  ) \n## Extension 1\ndatZ &lt;- read.table(\"C:\\\\Users\\\\5879167\\\\Documents\\\\GitHub\\\\RI-CLPM\\\\data\\\\RICLPM-Z.dat\",\n                   col.names = c(\n                     \"x1\", \"x2\", \"x3\", \"x4\", \"x5\", \n                     \"y1\", \"y2\", \"y3\", \"y4\", \"y5\", \"z2\", \"z1\")\n                   )\n## Extension 2\ndatMG &lt;- read.table(\"/Users/jeroenmulder/Git/RICLPM/data/RICLPM-MG.dat\",\n                    col.names = c(\n                      \"x1\", \"x2\", \"x3\", \"x4\", \"x5\", \n                      \"y1\", \"y2\", \"y3\", \"y4\", \"y5\", \"G\")\n                    ) \n## Extension 3\ndatMI &lt;- read.table(\"/Users/jeroenmulder/GitHub/RI-CLPM/data/RICLPM-MI.dat\",\n                   col.names = c(\n                     \"x11\", \"x12\", \"x13\",\n                     \"x21\", \"x22\", \"x23\",\n                     \"x31\", \"x32\", \"x33\",\n                     \"x41\", \"x42\", \"x43\",\n                     \"x51\", \"x52\", \"x53\", \n                                \n                     \"y11\", \"y12\", \"y13\",\n                     \"y21\", \"y22\", \"y23\",\n                     \"y31\", \"y32\", \"y33\", \n                     \"y41\", \"y42\", \"y43\", \n                     \"y51\", \"y52\", \"y53\")\n                    )\n\n\nThe RI-CLPM\nTo specify the RI-CLPM we need four parts.\n\nA between part, consisting of the random intercepts. It is specified using the =~ command, RIx =~ 1*x1 + 1*x2 ..., where 1* fixes the factor loading to one.\nA within part, consisting of within-unit fluctuations. It is also specified using the =~ command, wx1 =~ 1*x1; wx2 =~ 1*x2; ....\nThe lagged regressions between the within-unit components, using wx2 + wy2 ~ wx1 + wy1; wx3 + wy3 ~ wx2 + wy2; ....\nRelevant covariances in both the between and within part. In the within part the components at wave 1, and their residuals at waves 2 and further are correlated within each wave, using wx1 ~~ wy1; wx2 ~~ wy2;.... We also need to specify their (residual) variances here using wx1 ~~ wx1; wx2 ~~ wx2; .... For the between part we have to specify the variances and covariance of the random intercepts using RIx ~~ RIy;.\n\n\n\n\n\n\n\nThe models below are fitted using the lavaan() function. Other functions for fitting SEM models using lavaan include sem() and cfa(). These functions rely on different defaults than lavaan() and fitting the below models with these functions can result in model misspecification and subsequently convergence issues.\n\n\n\n\nThe basic modelConstraints over timeConstrain standardized lagged effects\n\n\nThe code for specifying the basic RI-CLPM is given below.\n\nRICLPM &lt;- '\n  # Create between components (random intercepts)\n  RIx =~ 1*x1 + 1*x2 + 1*x3 + 1*x4 + 1*x5\n  RIy =~ 1*y1 + 1*y2 + 1*y3 + 1*y4 + 1*y5\n  \n  # Create within-person centered variables\n  wx1 =~ 1*x1\n  wx2 =~ 1*x2\n  wx3 =~ 1*x3 \n  wx4 =~ 1*x4\n  wx5 =~ 1*x5\n  wy1 =~ 1*y1\n  wy2 =~ 1*y2\n  wy3 =~ 1*y3\n  wy4 =~ 1*y4\n  wy5 =~ 1*y5\n\n  # Estimate lagged effects between within-person centered variables\n  wx2 + wy2 ~ wx1 + wy1\n  wx3 + wy3 ~ wx2 + wy2\n  wx4 + wy4 ~ wx3 + wy3\n  wx5 + wy5 ~ wx4 + wy4\n\n  # Estimate covariance between within-person centered variables at first wave\n  wx1 ~~ wy1 # Covariance\n  \n  # Estimate covariances between residuals of within-person centered variables \n  # (i.e., innovations)\n  wx2 ~~ wy2\n  wx3 ~~ wy3\n  wx4 ~~ wy4\n  wx5 ~~ wy5\n  \n  # Estimate variance and covariance of random intercepts\n  RIx ~~ RIx\n  RIy ~~ RIy\n  RIx ~~ RIy\n\n  # Estimate (residual) variance of within-person centered variables\n  wx1 ~~ wx1 # Variances\n  wy1 ~~ wy1 \n  wx2 ~~ wx2 # Residual variances\n  wy2 ~~ wy2 \n  wx3 ~~ wx3 \n  wy3 ~~ wy3 \n  wx4 ~~ wx4 \n  wy4 ~~ wy4 \n  wx5 ~~ wx5\n  wy5 ~~ wy5\n'\n\n\n\nImposing constraints to the model can be achieved through pre-multiplication. It means that we have to prepend the number that we want to fix the parameter to, and an asterisk, to the parameter in the model specification. For example, F =~ 0*x1 fixes the factor loading of item x1 to factor F to 0. Using pre-multiplication we can also constrain parameters to be the same by giving them the same label. Below we specify an RI-CLPM with the following constraints:\n\nfixed auto-regressive and cross-lagged relations over time, wx2 ~ a*wx1 + b*wy1; ...,\ntime-invariant (residual) (co-)variances in the within-person part wx2 ~~ cov*wy2; ..., wx2 ~~ vx*wx2; ..., and wy2 ~~ vy*wy2; ..., and\nconstrained grand means over time, x1 + ... ~ mx*1 and y1 + ... ~ my*1.\n\n\nRICLPM5 &lt;- '\n  # Create between components (random intercepts)\n  RIx =~ 1*x1 + 1*x2 + 1*x3 + 1*x4 + 1*x5\n  RIy =~ 1*y1 + 1*y2 + 1*y3 + 1*y4 + 1*y5\n  \n  # Create within-person centered variables\n  wx1 =~ 1*x1\n  wx2 =~ 1*x2\n  wx3 =~ 1*x3 \n  wx4 =~ 1*x4\n  wx5 =~ 1*x5\n  wy1 =~ 1*y1\n  wy2 =~ 1*y2\n  wy3 =~ 1*y3\n  wy4 =~ 1*y4\n  wy5 =~ 1*y5\n  \n  # Estimate lagged effects between within-person centered variables \n  # (constrained)\n  wx2 ~ a*wx1 + b*wy1 \n  wy2 ~ c*wx1 + d*wy1\n  wx3 ~ a*wx2 + b*wy2\n  wy3 ~ c*wx2 + d*wy2\n  wx4 ~ a*wx3 + b*wy3\n  wy4 ~ c*wx3 + d*wy3\n  wx5 ~ a*wx4 + b*wy4\n  wy5 ~ c*wx4 + d*wy4\n  \n  # Estimate covariances between residuals of within-person centered variables \n  # (i.e., innovations, constrained)\n  wx2 ~~ cov*wy2\n  wx3 ~~ cov*wy3\n  wx4 ~~ cov*wy4 \n  wx5 ~~ cov*wy5\n  \n  # Estimate covariance between within-person centered variables at first wave\n  wx1 ~~ wy1 # Covariance\n  \n  # Estimate variance and covariance of random intercepts\n  RIx ~~ RIx\n  RIy ~~ RIy\n  RIx ~~ RIy\n  \n  # Estimate (residual) variance of within-person centered variables \n  # (constrained)\n  wx1 ~~ wx1 # Variance\n  wy1 ~~ wy1 \n  wx2 ~~ vx*wx2 # Residual variance\n  wy2 ~~ vy*wy2 \n  wx3 ~~ vx*wx3 \n  wy3 ~~ vy*wy3 \n  wx4 ~~ vx*wx4 \n  wy4 ~~ vy*wy4 \n  wx5 ~~ vx*wx5\n  wy5 ~~ vy*wy5\n  \n  # Constrain grand means over time\n  x1 + x2 + x3 + x4 + x5 ~ mx*1\n  y1 + y2 + y3 + y4 + y5 ~ my*1\n'\nRICLPM5.fit &lt;- lavaan(RICLPM5, \n  data = dat, \n  missing = 'ML', \n  meanstructure = T, \n  int.ov.free = T\n) \nsummary(RICLPM5.fit, standardized = T)\n\n\n\nRather than imposing constraints on the unstandardized auto-regressive and cross-lagged relations over time, we can impose constraints on the standardized lagged effects, as explained in the FAQ. Compared to the previous model (with constraints over time on the unstandardized lagged effects), there are multiple changes to the syntax. First, we freely estimate the factor loadings that link the observed variables to the within-components (by premultiplying with NA), rather than fixing them to 1:\n\n'\n  # Create within-components with freely estimated factor loadings\n  wx1 =~ NA*x1\n  wx2 =~ NA*x2\n  wx3 =~ NA*x3 \n  wx4 =~ NA*x4\n  wx5 =~ NA*x5\n  wy1 =~ NA*y1\n  wy2 =~ NA*y2\n  wy3 =~ NA*y3\n  wy4 =~ NA*y4\n  wy5 =~ NA*y5\n'\n\nSecond, we set the variances of within-components at first wave to 1, and label the covariance (now also the correlation) between them:\n\n'\n  # Set variances of within-components at first wave to 1\n  wx1 ~~ 1*wx1\n  wy1 ~~ 1*wy1\n  \n  # Estimate correlation between within-components at first wave\n  wx1 ~~ cor1*wy1 \n'\n\nThird, we give the residual variance and covariances between the within-component each a unique label:\n\n'\n  # Label residual covariances\n  wx2 ~~ rcov2*wy2\n  wx3 ~~ rcov3*wy3\n  wx4 ~~ rcov4*wy4 \n  wx5 ~~ rcov5*wy5\n  \n  # Label residual variances\n  wx2 ~~ rvx2*wx2 \n  wy2 ~~ rvy2*wy2 \n  wx3 ~~ rvx3*wx3 \n  wy3 ~~ rvy3*wy3 \n  wx4 ~~ rvx4*wx4 \n  wy4 ~~ rvy4*wy4 \n  wx5 ~~ rvx5*wx5\n  wy5 ~~ rvy5*wy5\n\n'\n\nFinally, we compute the correlations between the within-components themselves at each wave, and then constrain the residual variances to ensure that the total variance of each within-component equals 1. This is done with the := command:\n\n'\n  # Compute correlations of within-components at each wave\n  cor2 := a*c + b*d + a*d*cor1 + b*c*cor1 + rcov2\n  cor3 := a*c + b*d + a*d*cor2 + b*c*cor2 + rcov3\n  cor4 := a*c + b*d + a*d*cor3 + b*c*cor3 + rcov4\n \n  # Contrain residual variances of within-components such that variance of each \n  # within-component equals 1\n  rvx2 == 1 - (a*a + b*b + 2*a*b*cor1)\n  rvy2 == 1 - (c*c + d*d + 2*c*d*cor1)\n  rvx3 == 1 - (a*a + b*b + 2*a*b*cor2)\n  rvy3 == 1 - (c*c + d*d + 2*c*d*cor2)\n  rvx4 == 1 - (a*a + b*b + 2*a*b*cor3)\n  rvy4 == 1 - (c*c + d*d + 2*c*d*cor3)\n  rvx5 == 1 - (a*a + b*b + 2*a*b*cor4)\n  rvy5 == 1 - (c*c + d*d + 2*c*d*cor4)\n'\n\nThese steps ultimately result in the below syntax. Comparing the constrainted unstandardized and constrained standardized results shows that these are now equivalent.\n\nRICLPM6 &lt;- '\n  # Create between components (random intercepts)\n  RIx =~ 1*x1 + 1*x2 + 1*x3 + 1*x4 + 1*x5\n  RIy =~ 1*y1 + 1*y2 + 1*y3 + 1*y4 + 1*y5\n  \n  # Create within-components with freely estimated factor loadings\n  wx1 =~ NA*x1\n  wx2 =~ NA*x2\n  wx3 =~ NA*x3 \n  wx4 =~ NA*x4\n  wx5 =~ NA*x5\n  wy1 =~ NA*y1\n  wy2 =~ NA*y2\n  wy3 =~ NA*y3\n  wy4 =~ NA*y4\n  wy5 =~ NA*y5\n  \n  # Estimate lagged effects between within-person centered variables \n  # (constrained)\n  wx2 ~ a*wx1 + b*wy1 \n  wy2 ~ c*wx1 + d*wy1\n  wx3 ~ a*wx2 + b*wy2\n  wy3 ~ c*wx2 + d*wy2\n  wx4 ~ a*wx3 + b*wy3\n  wy4 ~ c*wx3 + d*wy3\n  wx5 ~ a*wx4 + b*wy4\n  wy5 ~ c*wx4 + d*wy4\n  \n  # Label residual covariances\n  wx2 ~~ rcov2*wy2\n  wx3 ~~ rcov3*wy3\n  wx4 ~~ rcov4*wy4 \n  wx5 ~~ rcov5*wy5\n  \n  # Estimate correlation between within-components at first wave\n  wx1 ~~ cor1*wy1 \n  \n  # Estimate variance and covariance of random intercepts\n  RIx ~~ RIx\n  RIy ~~ RIy\n  RIx ~~ RIy\n  \n  # Set variances of within-components at first wave to 1\n  wx1 ~~ 1*wx1\n  wy1 ~~ 1*wy1\n  \n  # Label residual variances\n  wx2 ~~ rvx2*wx2 \n  wy2 ~~ rvy2*wy2 \n  wx3 ~~ rvx3*wx3 \n  wy3 ~~ rvy3*wy3 \n  wx4 ~~ rvx4*wx4 \n  wy4 ~~ rvy4*wy4 \n  wx5 ~~ rvx5*wx5\n  wy5 ~~ rvy5*wy5\n  \n  # Constrain grand means over time\n  x1 + x2 + x3 + x4 + x5 ~ mx*1\n  y1 + y2 + y3 + y4 + y5 ~ my*1\n  \n  # Compute correlations of within-components at each wave\n  cor2 := a*c + b*d + a*d*cor1 + b*c*cor1 + rcov2\n  cor3 := a*c + b*d + a*d*cor2 + b*c*cor2 + rcov3\n  cor4 := a*c + b*d + a*d*cor3 + b*c*cor3 + rcov4\n \n  # Contrain residual variances of within-components such that variance of each \n  # within-component equals 1\n  rvx2 == 1 - (a*a + b*b + 2*a*b*cor1)\n  rvy2 == 1 - (c*c + d*d + 2*c*d*cor1)\n  rvx3 == 1 - (a*a + b*b + 2*a*b*cor2)\n  rvy3 == 1 - (c*c + d*d + 2*c*d*cor2)\n  rvx4 == 1 - (a*a + b*b + 2*a*b*cor3)\n  rvy4 == 1 - (c*c + d*d + 2*c*d*cor3)\n  rvx5 == 1 - (a*a + b*b + 2*a*b*cor4)\n  rvy5 == 1 - (c*c + d*d + 2*c*d*cor4)\n'\nRICLPM6.fit &lt;- lavaan(RICLPM6, \n  data = dat, \n  missing = 'ML', \n  meanstructure = T, \n  int.ov.free = T\n) \nsummary(RICLPM6.fit, standardized = F)\nsummary(RICLPM6.fit, standardized = T)\n\n\n\n\n\n\nExtension 1: Including time-invariant predictors and outcomes\nUse the tabs below to navigate to the model specification of the RI-CLPM with\n\na time-invariant predictor \\(z_{1}\\) of the observed variables (\\(z_{1}\\) \\(\\rightarrow\\) observed),\na time-invariant predictor \\(z_{1}\\) of the random intercepts (\\(z_{1}\\) \\(\\rightarrow\\) RIs),\nrandom intercepts predicting a time-invariant outcome \\(z_{2}\\) (RIs \\(\\rightarrow\\) \\(z_{2}\\)), or\nwithin components predicting a time-invariant outcome \\(z_{2}\\) (within \\(\\rightarrow\\) \\(z_{2}\\)).\n\n\n\\(z_{1}\\) \\(\\rightarrow\\) observed\\(z_{1}\\) \\(\\rightarrow\\) RIsRIs \\(\\rightarrow\\) \\(z_{2}\\)within \\(\\rightarrow\\) \\(z_{2}\\)\n\n\nBelow you can find the code for an RI-CLPM with 5 waves and a time-invariant predictor \\(z_{1}\\) for the observed variables. The effect of \\(z_{1}\\) on the observed variables is constrained to be the same across waves.\n\nRICLPM.ext1 &lt;- '\n  # Create between components (random intercepts)\n  RIx =~ 1*x1 + 1*x2 + 1*x3 + 1*x4 + 1*x5\n  RIy =~ 1*y1 + 1*y2 + 1*y3 + 1*y4 + 1*y5\n  \n  # Create within-person centered variables\n  wx1 =~ 1*x1\n  wx2 =~ 1*x2\n  wx3 =~ 1*x3 \n  wx4 =~ 1*x4\n  wx5 =~ 1*x5\n  wy1 =~ 1*y1\n  wy2 =~ 1*y2\n  wy3 =~ 1*y3\n  wy4 =~ 1*y4\n  wy5 =~ 1*y5\n  \n  # Regression of observed variables on z1 (constrained)\n  x1 + x2 + x3 + x4 + x5 ~ s1*z1 # Constrained over time. \n  y1 + y2 + y3 + y4 + y5 ~ s2*z1 # Constrained over time. \n  \n  # Estimate lagged effects between within-person centered variables\n  wx2 + wy2 ~ wx1 + wy1\n  wx3 + wy3 ~ wx2 + wy2\n  wx4 + wy4 ~ wx3 + wy3\n  wx5 + wy5 ~ wx4 + wy4\n  \n  # Estimate covariance between within-person centered variables at first wave\n  wx1 ~~ wy1 # Covariance\n  \n  # Estimate covariances between residuals of within-person centered variables\n  # (i.e., innovations)\n  wx2 ~~ wy2\n  wx3 ~~ wy3\n  wx4 ~~ wy4\n  wx5 ~~ wy5\n  \n  # Estimate variance and covariance of random intercepts\n  RIx ~~ RIx\n  RIy ~~ RIy\n  RIx ~~ RIy\n  \n  # Estimate (residual) variance of within-person centered variables\n  wx1 ~~ wx1 # Variances\n  wy1 ~~ wy1 \n  wx2 ~~ wx2 # Residual variances\n  wy2 ~~ wy2 \n  wx3 ~~ wx3 \n  wy3 ~~ wy3 \n  wx4 ~~ wx4 \n  wy4 ~~ wy4 \n  wx5 ~~ wx5\n  wy5 ~~ wy5\n'\nRICLPM.ext1.fit &lt;- lavaan(RICLPM.ext1, \n  data = datZ, \n  missing = 'ML', \n  meanstructure = T, \n  int.ov.free = T\n) \nsummary(RICLPM.ext1.fit, standardized = T)\n\n\n\nBelow you can find the code for an RI-CLPM with 5 waves and a time-invariant predictor \\(z_{1}\\) for the random intercepts.\n\nRICLPM1.ext1 &lt;- '\n  # Create between components (random intercepts)\n  RIx =~ 1*x1 + 1*x2 + 1*x3 + 1*x4 + 1*x5\n  RIy =~ 1*y1 + 1*y2 + 1*y3 + 1*y4 + 1*y5\n  \n  # Estimate variance and covariance of random intercepts\n  RIx ~~ RIx\n  RIy ~~ RIy\n  RIx ~~ RIy\n  \n  # Regression of random intercepts on z1\n  RIx + RIy ~ z1 # Constrained over time. \n  \n  # Create within-person centered variables\n  wx1 =~ 1*x1\n  wx2 =~ 1*x2\n  wx3 =~ 1*x3 \n  wx4 =~ 1*x4\n  wx5 =~ 1*x5\n  wy1 =~ 1*y1\n  wy2 =~ 1*y2\n  wy3 =~ 1*y3\n  wy4 =~ 1*y4\n  wy5 =~ 1*y5\n  \n  # Estimate lagged effects between within-person centered variables\n  wx2 + wy2 ~ wx1 + wy1\n  wx3 + wy3 ~ wx2 + wy2\n  wx4 + wy4 ~ wx3 + wy3\n  wx5 + wy5 ~ wx4 + wy4\n  \n  # Estimate covariance between within-person centered variables at first wave\n  wx1 ~~ wy1 # Covariance\n  \n  # Estimate covariances between residuals of within-person centered variables \n  # (i.e., innovations)\n  wx2 ~~ wy2\n  wx3 ~~ wy3\n  wx4 ~~ wy4\n  wx5 ~~ wy5\n  \n  # Estimate (residual) variance of within-person centered variables\n  wx1 ~~ wx1 # Variances\n  wy1 ~~ wy1 \n  wx2 ~~ wx2 # Residual variances\n  wy2 ~~ wy2 \n  wx3 ~~ wx3 \n  wy3 ~~ wy3 \n  wx4 ~~ wx4 \n  wy4 ~~ wy4 \n  wx5 ~~ wx5\n  wy5 ~~ wy5\n'\nRICLPM1.ext1.fit &lt;- lavaan(RICLPM1.ext1, \n  data = datZ, \n  missing = 'ML', \n  meanstructure = T, \n  int.ov.free = T\n) \nsummary(RICLPM1.ext1.fit, standardized = T)\n\n\n\nBelow you can find code for an RI-CLPM with the between components (the random intercepts) predicting a time-invariant outcome. For sake of completeness, the time-invariant \\(z_{1}\\) is also included as a predictor the for observed variables (constrained).\n\nRICLPM3.ext1 &lt;- '\n  # Create between components (random intercepts)\n  RIx =~ 1*x1 + 1*x2 + 1*x3 + 1*x4 + 1*x5\n  RIy =~ 1*y1 + 1*y2 + 1*y3 + 1*y4 + 1*y5\n  \n  # Estimate variance and covariance of random intercepts\n  RIx ~~ RIx\n  RIy ~~ RIy\n  RIx ~~ RIy\n  \n  # Regression of time-invariant outcome z2 on random intercepts\n  z2 ~ RIx + RIy\n  z2 ~~ z2 # Residual variance z2\n  \n  # Create within-person centered variables\n  wx1 =~ 1*x1\n  wx2 =~ 1*x2\n  wx3 =~ 1*x3 \n  wx4 =~ 1*x4\n  wx5 =~ 1*x5\n  wy1 =~ 1*y1\n  wy2 =~ 1*y2\n  wy3 =~ 1*y3\n  wy4 =~ 1*y4\n  wy5 =~ 1*y5\n  \n  # Regression of observed variables on z1 (constrained)\n  x1 + x2 + x3 + x4 + x5 ~ s1*z1 \n  y1 + y2 + y3 + y4 + y5 ~ s2*z1 \n  \n  # Estimate lagged effects between within-person centered variables\n  wx2 + wy2 ~ wx1 + wy1\n  wx3 + wy3 ~ wx2 + wy2\n  wx4 + wy4 ~ wx3 + wy3\n  wx5 + wy5 ~ wx4 + wy4\n  \n  # Estimate covariance between within-person centered variables at first wave \n  wx1 ~~ wy1 \n  \n  # Estimate covariances between residuals of within-person centered variables \n  # (i.e., innovations)\n  wx2 ~~ wy2\n  wx3 ~~ wy3\n  wx4 ~~ wy4\n  wx5 ~~ wy5\n  \n  # Estimate (residual) variance of within-person centered variables\n  wx1 ~~ wx1 # Variances\n  wy1 ~~ wy1 \n  wx2 ~~ wx2 # Residual variances\n  wy2 ~~ wy2 \n  wx3 ~~ wx3 \n  wy3 ~~ wy3 \n  wx4 ~~ wx4 \n  wy4 ~~ wy4 \n  wx5 ~~ wx5\n  wy5 ~~ wy5\n'\nRICLPM3.ext1.fit &lt;- lavaan(RICLPM3.ext1, \n  data = datZ, \n  missing = 'ML', \n  meanstructure = T, \n  int.ov.free = T\n) \nsummary(RICLPM3.ext1.fit, standardized = T)\n\n\n\nBelow you can find code for an RI-CLPM with the within components predicting a time-invariant outcome. For sake of completeness, the time-invariant \\(z_{1}\\) is also included as a predictor the for observed variables (constrained).\n\nRICLPM4.ext1 &lt;- '\n  # Create between components (random intercepts)\n  RIx =~ 1*x1 + 1*x2 + 1*x3 + 1*x4 + 1*x5\n  RIy =~ 1*y1 + 1*y2 + 1*y3 + 1*y4 + 1*y5\n  \n  # Estimate variance and covariance of random intercepts\n  RIx ~~ RIx\n  RIy ~~ RIy\n  RIx ~~ RIy\n  \n  # Regression of time-invariant outcome z2 on within components\n  z2 ~ wx1 + wx2 + wx3 + wx4 + wx5 + wy1 + wy2 + wy3 + wy4 + wy5\n  z2 ~~ z2 # Residual variance z2\n  \n  # Create within-person centered variables\n  wx1 =~ 1*x1\n  wx2 =~ 1*x2\n  wx3 =~ 1*x3 \n  wx4 =~ 1*x4\n  wx5 =~ 1*x5\n  wy1 =~ 1*y1\n  wy2 =~ 1*y2\n  wy3 =~ 1*y3\n  wy4 =~ 1*y4\n  wy5 =~ 1*y5\n  \n  # Regression of observed variables on z1 (constrained) \n  x1 + x2 + x3 + x4 + x5 ~ s1*z1 \n  y1 + y2 + y3 + y4 + y5 ~ s2*z1 \n  \n  # Estimate lagged effects between within-person centered variables\n  wx2 + wy2 ~ wx1 + wy1\n  wx3 + wy3 ~ wx2 + wy2\n  wx4 + wy4 ~ wx3 + wy3\n  wx5 + wy5 ~ wx4 + wy4\n  \n  # Estimate covariance between within-person centered variables at first wave\n  wx1 ~~ wy1\n  \n  # Estimate covariances between residuals of within-person centered variables\n  # (i.e., innovations)\n  wx2 ~~ wy2\n  wx3 ~~ wy3\n  wx4 ~~ wy4\n  wx5 ~~ wy5\n  \n  # Estimate (residual) variance of within-person centered variables\n  wx1 ~~ wx1 # Variances\n  wy1 ~~ wy1 \n  wx2 ~~ wx2 # Residual variances\n  wy2 ~~ wy2 \n  wx3 ~~ wx3 \n  wy3 ~~ wy3 \n  wx4 ~~ wx4 \n  wy4 ~~ wy4 \n  wx5 ~~ wx5\n  wy5 ~~ wy5\n'\nRICLPM4.ext1.fit &lt;- lavaan(RICLPM4.ext1, \n  data = datZ, \n  missing = 'ML', \n  meanstructure = T, \n  int.ov.free = T\n) \nsummary(RICLPM4.ext1.fit, standardized = T)\n\n\n\n\n\n\nExtension 2: Multiple group\nUse the tabs below to navigate to the model specification of the basic multiple-group model, or the model with constrained lagged parameters (and intercepts across groups).\n\nThe basic modelConstrained lagged-parameters\n\n\nBelow you can find the code for a multiple group RI-CLPM with 5 waves.\n\nRICLPM.ext2 &lt;- '\n  # Create between components (random intercepts)\n  RIx =~ 1*x1 + 1*x2 + 1*x3 + 1*x4 + 1*x5\n  RIy =~ 1*y1 + 1*y2 + 1*y3 + 1*y4 + 1*y5\n  \n  # Create within-person centered variables\n  wx1 =~ 1*x1\n  wx2 =~ 1*x2\n  wx3 =~ 1*x3 \n  wx4 =~ 1*x4\n  wx5 =~ 1*x5\n  wy1 =~ 1*y1\n  wy2 =~ 1*y2\n  wy3 =~ 1*y3\n  wy4 =~ 1*y4\n  wy5 =~ 1*y5\n  \n  # Estimate lagged effects between within-person centered variables\n  wx2 + wy2 ~ wx1 + wy1\n  wx3 + wy3 ~ wx2 + wy2\n  wx4 + wy4 ~ wx3 + wy3\n  wx5 + wy5 ~ wx4 + wy4\n  \n  # Estimate covariance between within-person centered variables at first wave\n  wx1 ~~ wy1 \n  \n  # Estimate covariances between residuals of within-person centered variables \n  # (i.e., innovations)\n  wx2 ~~ wy2\n  wx3 ~~ wy3\n  wx4 ~~ wy4\n  wx5 ~~ wy5\n  \n  # Estimate variance and covariance of random intercepts \n  RIx ~~ RIx\n  RIy ~~ RIy\n  RIx ~~ RIy\n  \n  # Estimate (residual) variance of within-person centered variables\n  wx1 ~~ wx1 # Variances\n  wy1 ~~ wy1 \n  wx2 ~~ wx2 # Residual variances\n  wy2 ~~ wy2 \n  wx3 ~~ wx3 \n  wy3 ~~ wy3 \n  wx4 ~~ wx4 \n  wy4 ~~ wy4 \n  wx5 ~~ wx5\n  wy5 ~~ wy5\n'\nRICLPM.ext2.fit &lt;- lavaan(RICLPM.ext2, \n  data = datMG, \n  missing = 'ML', \n  group = \"G\", \n  meanstructure = T, \n  int.ov.free = T\n)\nsummary(RICLPM.ext2.fit)\n\n\n\nBelow you can find the code for a multiple group RI-CLPM with 4 waves. The lagged-parameters are constrained to be equal over time.\n\nRICLPM1.ext2 &lt;- '\n  # Create between components (random intercepts)\n  RIx =~ 1*x1 + 1*x2 + 1*x3 + 1*x4 + 1*x5\n  RIy =~ 1*y1 + 1*y2 + 1*y3 + 1*y4 + 1*y5\n  \n  # Create within-person centered variables\n  wx1 =~ 1*x1\n  wx2 =~ 1*x2\n  wx3 =~ 1*x3 \n  wx4 =~ 1*x4\n  wx5 =~ 1*x5\n  wy1 =~ 1*y1\n  wy2 =~ 1*y2\n  wy3 =~ 1*y3\n  wy4 =~ 1*y4\n  wy5 =~ 1*y5\n  \n  # Estimate lagged effects between within-person centered variables (constrain   \n  # autoregressive effects across groups) \n  wx2 ~ c(a1, a1)*wx1 + c(b1, b1)*wy1\n  wy2 ~ c(c1, c1)*wx1 + c(d1, d1)*wy1\n  wx3 ~ c(a2, a2)*wx2 + c(b2, b2)*wy2\n  wy3 ~ c(c2, c2)*wx2 + c(d2, d2)*wy2\n  wx4 ~ c(a3, a3)*wx3 + c(b3, b3)*wy3\n  wy4 ~ c(c3, c3)*wx3 + c(d3, d3)*wy3 \n  wx5 ~ c(a4, a4)*wx4 + c(b4, b4)*wy4\n  wy5 ~ c(c4, c4)*wx4 + c(d4, d4)*wy4\n  \n  # Estimate covariance between within-person centered variables at first wave\n  wx1 ~~ wy1\n  \n  # Estimate covariances between residuals of within-person centered variables \n  # (i.e., innovations)\n  wx2 ~~ wy2\n  wx3 ~~ wy3\n  wx4 ~~ wy4\n  wx5 ~~ wy5\n  \n  # Estimate variance and covariance of random intercepts\n  RIx ~~ RIx\n  RIy ~~ RIy\n  RIx ~~ RIy\n  \n  # Estimate (residual) variance of the within-person centered variables\n  wx1 ~~ wx1 # Variances\n  wy1 ~~ wy1 \n  wx2 ~~ wx2 # Residual variances\n  wy2 ~~ wy2 \n  wx3 ~~ wx3 \n  wy3 ~~ wy3 \n  wx4 ~~ wx4 \n  wy4 ~~ wy4 \n  wx5 ~~ wx5\n  wy5 ~~ wy5\n'\nRICLPM1.ext2.fit &lt;- lavaan(RICLPM1.ext2, \n  data = datMG, \n  missing = 'ML', \n  group = \"G\", \n  meanstructure = T, \n  int.ov.free = T\n)\nsummary(RICLPM1.ext2.fit)\n\n\n\n\n\n\nExtension 3: Multiple indicators\nUse the tabs below to navigate to the model specification of a multiple indicator RI-CLPM, 5 waves and 3 indicators for each variable at each wave. The five steps correspond to:\n\nthe configural model (Step 1),\nweak factorial invariance (Step 2),\nstrong factorial invariance (Step 3),\nstrong factorial invariance with factor loadings equal to the within-person factor loadings (Extra), and\nthe latent RI-CLPM (Step 4).\n\n\nStep 1Step 2Step 3ExtraStep 4\n\n\nWhen we have three indicators \\(X\\), measured at five waves, we specify three random intercepts to capture the trait-like part of each indicator, that is, RIX1 =~ 1*x11 1*x21 ..., RIX2 =~ 1*x121 1*x22@1 ..., and RIX3 =~ 1*x13 1*x23 .... In addition, we specify five within-unit components that capture the state-like part at each wave, using WFX1 =~ x11 x12 x13; WFX2 =~ x21 x22 x23; ....\nAt the latent within-unit level, we specify the dynamic model in Mplus using WFX2 ~ WFY1 + WFX1; WFX3 ~ WFY2 + WFX2; .... In addition, we allow the within-person factors at the first wave, and their residuals at subsequent waves to be correlated within each wave, WFX1 ~~ WFY1; WFX2 ~~ WFY2; .... The six random intercepts are allowed to be freely correlated with each other, either through inclusion of RIX1 + RIX2 + ... ~~ RIX1 + RIX2 + ... in the model syntax, or by default when using the cfa() function as we have done below.\n\nRICLPM1.ext3 &lt;- '\n  \n  ################\n  # BETWEEN PART #\n  ################\n  \n  # Create between factors (random intercepts) for each indicator separately\n  RIX1 =~ 1*x11 + 1*x21 + 1*x31 + 1*x41 + 1*x51\n  RIX2 =~ 1*x12 + 1*x22 + 1*x32 + 1*x42 + 1*x52\n  RIX3 =~ 1*x13 + 1*x23 + 1*x33 + 1*x43 + 1*x53\n  \n  RIY1 =~ 1*y11 + 1*y21 + 1*y31 + 1*y41 + 1*y51\n  RIY2 =~ 1*y12 + 1*y22 + 1*y32 + 1*y42 + 1*y52\n  RIY3 =~ 1*y13 + 1*y23 + 1*y33 + 1*y43 + 1*y53\n  \n  ##################################\n  # WITHIN PART: MEASUREMENT MODEL #\n  ##################################\n  \n  # Factor models for X at 5 waves\n  WFX1 =~ x11 + x12 + x13\n  WFX2 =~ x21 + x22 + x23\n  WFX3 =~ x31 + x32 + x33\n  WFX4 =~ x41 + x42 + x43\n  WFX5 =~ x51 + x52 + x53\n  \n  # Factor models for Y at 5 waves\n  WFY1 =~ y11 + y12 + y13\n  WFY2 =~ y21 + y22 + y23\n  WFY3 =~ y31 + y32 + y33\n  WFY4 =~ y41 + y42 + y43\n  WFY5 =~ y51 + y52 + y53\n  \n  #########################\n  # WITHIN PART: DYNAMICS #\n  #########################\n  \n  # Specify lagged effects between within-person centered latent variables\n  WFX2 + WFY2 ~ WFX1 + WFY1\n  WFX3 + WFY3 ~ WFX2 + WFY2\n  WFX4 + WFY4 ~ WFX3 + WFY3\n  WFX5 + WFY5 ~ WFX4 + WFY4\n  \n  # Estimate correlations within same wave\n  WFX1 ~~ WFY1\n  WFX2 ~~ WFY2\n  WFX3 ~~ WFY3 \n  WFX4 ~~ WFY4\n  WFX5 ~~ WFY5\n  \n  ##########################\n  # ADDITIONAL CONSTRAINTS #\n  ##########################\n  \n  # Constrain covariance of between factors and exogenous within factors to 0 \n  RIX1 + RIX2 + RIX3 + RIY1 + RIY2 + RIY3 ~~ 0*WFY1 + 0*WFX1\n'\nRICLPM1.ext3.fit &lt;- cfa(RICLPM1.ext3, \n  data = datMI, \n  missing = 'ML',\n  meanstructure = TRUE\n)\nsummary(RICLPM1.ext3.fit, standardized = T)\n\n\n\nIn second step, we constrain the factor loadings to be invariant over time using the labels a*, b*, etc.\n\nRICLPM2.ext3 &lt;- '\n  \n  ################\n  # BETWEEN PART #\n  ################\n  \n  # Create between factors (random intercepts) for each indicator separately\n  RIX1 =~ 1*x11 + 1*x21 + 1*x31 + 1*x41 + 1*x51\n  RIX2 =~ 1*x12 + 1*x22 + 1*x32 + 1*x42 + 1*x52\n  RIX3 =~ 1*x13 + 1*x23 + 1*x33 + 1*x43 + 1*x53\n  \n  RIY1 =~ 1*y11 + 1*y21 + 1*y31 + 1*y41 + 1*y51\n  RIY2 =~ 1*y12 + 1*y22 + 1*y32 + 1*y42 + 1*y52\n  RIY3 =~ 1*y13 + 1*y23 + 1*y33 + 1*y43 + 1*y53\n  \n  ##################################\n  # WITHIN PART: MEASUREMENT MODEL #\n  ##################################\n  \n  # Factor models for X at 5 waves (constrained)\n  WFX1 =~ a*x11 + b*x12 + c*x13\n  WFX2 =~ a*x21 + b*x22 + c*x23\n  WFX3 =~ a*x31 + b*x32 + c*x33\n  WFX4 =~ a*x41 + b*x42 + c*x43\n  WFX5 =~ a*x51 + b*x52 + c*x53\n  \n  # Factor models for Y at 5 waves (constrained)\n  WFY1 =~ d*y11 + e*y12 + f*y13\n  WFY2 =~ d*y21 + e*y22 + f*y23\n  WFY3 =~ d*y31 + e*y32 + f*y33\n  WFY4 =~ d*y41 + e*y42 + f*y43\n  WFY5 =~ d*y51 + e*y52 + f*y53\n  \n  #########################\n  # WITHIN PART: DYNAMICS #\n  #########################\n  \n  # Specify lagged effects between within-person centered latent variables\n  WFX2 + WFY2 ~ WFX1 + WFY1\n  WFX3 + WFY3 ~ WFX2 + WFY2\n  WFX4 + WFY4 ~ WFX3 + WFY3\n  WFX5 + WFY5 ~ WFX4 + WFY4\n  \n  # Estimate correlations within same wave\n  WFX1 ~~ WFY1\n  WFX2 ~~ WFY2\n  WFX3 ~~ WFY3 \n  WFX4 ~~ WFY4\n  WFX5 ~~ WFY5\n  \n  ##########################\n  # ADDITIONAL CONSTRAINTS #\n  ##########################\n  \n  # Constrain covariance of between factors and exogenous within factors to 0\n  RIX1 + RIX2 + RIX3 + RIY1 + RIY2 + RIY3 ~~ 0*WFY1 + 0*WFX1\n'\nRICLPM2.ext3.fit &lt;- cfa(RICLPM2.ext3, \n  data = datMI, \n  missing = 'ML'\n)\nsummary(RICLPM2.ext3.fit, standardized = T)\n\n\n\nMultiple indicator RI-CLPM 4 waves with 3 indicators for each variable at each wave (24 observed variables). Fitting a model with constraints to ensure strong factorial invariance, with a random intercept for each indicator separately.\n\nRICLPM3.ext3 &lt;- '\n  \n  ################\n  # BETWEEN PART #\n  ################\n  \n  # Create between factors (random intercepts) for each indicator separately\n  RIX1 =~ 1*x11 + 1*x21 + 1*x31 + 1*x41 + 1*x51\n  RIX2 =~ 1*x12 + 1*x22 + 1*x32 + 1*x42 + 1*x52\n  RIX3 =~ 1*x13 + 1*x23 + 1*x33 + 1*x43 + 1*x53\n  \n  RIY1 =~ 1*y11 + 1*y21 + 1*y31 + 1*y41 + 1*y51\n  RIY2 =~ 1*y12 + 1*y22 + 1*y32 + 1*y42 + 1*y52\n  RIY3 =~ 1*y13 + 1*y23 + 1*y33 + 1*y43 + 1*y53\n  \n  ##################################\n  # WITHIN PART: MEASUREMENT MODEL #\n  ##################################\n  \n  # Factor models for X at 5 waves (constrained)\n  WFX1 =~ a*x11 + b*x12 + c*x13\n  WFX2 =~ a*x21 + b*x22 + c*x23\n  WFX3 =~ a*x31 + b*x32 + c*x33\n  WFX4 =~ a*x41 + b*x42 + c*x43\n  WFX5 =~ a*x51 + b*x52 + c*x53\n  \n  # Factor models for Y at 5 waves (constrained)\n  WFY1 =~ d*y11 + e*y12 + f*y13\n  WFY2 =~ d*y21 + e*y22 + f*y23\n  WFY3 =~ d*y31 + e*y32 + f*y33\n  WFY4 =~ d*y41 + e*y42 + f*y43\n  WFY5 =~ d*y51 + e*y52 + f*y53\n  \n  # Constrained intercepts over time (necessary for strong factorial \n  # invariance; without these contraints we have week factorial invariance) \n  x11 + x21 + x31 + x41 + x51 ~ g*1\n  x12 + x22 + x32 + x42 + x52 ~ h*1\n  x13 + x23 + x33 + x43 + x53 ~ i*1\n  y11 + y21 + y31 + y41 + y51 ~ j*1\n  y12 + y22 + y32 + y42 + y52 ~ k*1\n  y13 + y23 + y33 + y43 + y53 ~ l*1\n  \n  # Free latent means from t = 2 onward (only do this in combination with  \n  # constraints on intercepts; without these, this would not be specified)\n  WFX2 + WFX3 + WFX4 + WFX5 + WFY2 + WFY3 + WFY4 + WFY5 ~ 1\n  \n  #########################\n  # WITHIN PART: DYNAMICS #\n  #########################\n  \n  # Specify lagged effects between within-person centered latent variables\n  WFX2 + WFY2 ~ WFX1 + WFY1\n  WFX3 + WFY3 ~ WFX2 + WFY2\n  WFX4 + WFY4 ~ WFX3 + WFY3\n  WFX5 + WFY5 ~ WFX4 + WFY4\n  \n  # Estimate correlations within same wave\n  WFX1 ~~ WFY1\n  WFX2 ~~ WFY2\n  WFX3 ~~ WFY3 \n  WFX4 ~~ WFY4\n  WFX5 ~~ WFY5\n  \n  ##########################\n  # ADDITIONAL CONSTRAINTS #\n  ##########################\n  \n  # Constrain covariance of between factors and exogenous within factors to 0\n  RIX1 + RIX2 + RIX3 + RIY1 + RIY2 + RIY3 ~~ 0*WFY1 + 0*WFX1\n'\nRICLPM3.ext3.fit &lt;- cfa(RICLPM3.ext3, \n  data = datMI, \n  missing = 'ML'\n)\nsummary(RICLPM3.ext3.fit, standardized = T)\n\n\n\nMultiple indicator RI-CLPM, 5 waves with 3 indicators for each variable at each wave (30 observed variables). Fitting a model With constraints to ensure strong factorial invariance, with a random intercept for each indicator separately, for which a factor model is specified, with factor loadings equal to the within- person factor loadings.\n\nRICLPM4.ext3 &lt;- '\n  \n  ################\n  # BETWEEN PART #\n  ################\n  \n  # Create between factors (random intercepts) for each indicator separately\n  RIX1 =~ 1*x11 + 1*x21 + 1*x31 + 1*x41 + 1*x51\n  RIX2 =~ 1*x12 + 1*x22 + 1*x32 + 1*x42 + 1*x52\n  RIX3 =~ 1*x13 + 1*x23 + 1*x33 + 1*x43 + 1*x53\n  \n  RIY1 =~ 1*y11 + 1*y21 + 1*y31 + 1*y41 + 1*y51\n  RIY2 =~ 1*y12 + 1*y22 + 1*y32 + 1*y42 + 1*y52\n  RIY3 =~ 1*y13 + 1*y23 + 1*y33 + 1*y43 + 1*y53\n  \n  # Create a single random intercept for all X variables, and another for all \n  # Y variables and constrain the factor loadings to be identical to\n  # within-person factor loadings\n  \n  RIX =~ a*RIX1 + b*RIX2 + c*RIX3\n  RIY =~ d*RIY1 + e*RIY2 + f*RIY3\n  \n  # Add (co)variance between two higher-order random intercepts\n  RIX ~~ RIY\n  RIX ~~ RIX\n  RIY ~~ RIY\n  \n  # Constrain measurement error variances of the second order factor model to 0 \n  RIX1 ~~ 0*RIX1\n  RIX2 ~~ 0*RIX2\n  RIX3 ~~ 0*RIX3\n  RIY1 ~~ 0*RIY1\n  RIY2 ~~ 0*RIY2\n  RIY3 ~~ 0*RIY3\n  \n  ##################################\n  # WITHIN PART: MEASUREMENT MODEL #\n  ##################################\n  \n  # Factor models for X at 5 waves (constrained)\n  WFX1 =~ a*x11 + b*x12 + c*x13\n  WFX2 =~ a*x21 + b*x22 + c*x23\n  WFX3 =~ a*x31 + b*x32 + c*x33\n  WFX4 =~ a*x41 + b*x42 + c*x43\n  WFX5 =~ a*x51 + b*x52 + c*x53\n  \n  # Factor models for Y at 5 waves (constrained)\n  WFY1 =~ d*y11 + e*y12 + f*y13\n  WFY2 =~ d*y21 + e*y22 + f*y23\n  WFY3 =~ d*y31 + e*y32 + f*y33\n  WFY4 =~ d*y41 + e*y42 + f*y43\n  WFY5 =~ d*y51 + e*y52 + f*y53\n  \n  # Constrained intercepts over time (necessary for strong factorial invariance; \n  # without these contraints we have week factorial invariance)\n  x11 + x21 + x31 + x41 + x51 ~ g*1\n  x12 + x22 + x32 + x42 + x52 ~ h*1\n  x13 + x23 + x33 + x43 + x53 ~ i*1\n  y11 + y21 + y31 + y41 + y51 ~ j*1\n  y12 + y22 + y32 + y42 + y52 ~ k*1\n  y13 + y23 + y33 + y43 + y53 ~ l*1\n  \n  # Free latent means from t = 2 onward (only do this in combination with  \n  # constraints on intercepts; without these, this would not be identified)\n  WFX2 + WFX3 + WFX4 + WFX5 + WFY2 + WFY3 + WFY4 + WFY5 ~ 1\n  \n  #########################\n  # WITHIN PART: DYNAMICS #\n  #########################\n  \n  # Specify lagged effects between within-person centered latent variables\n  WFX2 + WFY2 ~ WFX1 + WFY1\n  WFX3 + WFY3 ~ WFX2 + WFY2\n  WFX4 + WFY4 ~ WFX3 + WFY3\n  WFX5 + WFY5 ~ WFX4 + WFY4\n  \n  # Estimate correlations within same wave\n  WFX1 ~~ WFY1\n  WFX2 ~~ WFY2\n  WFX3 ~~ WFY3 \n  WFX4 ~~ WFY4\n  WFX5 ~~ WFY5\n  \n  ##########################\n  # ADDITIONAL CONSTRAINTS #\n  ##########################\n  \n  # Constrain covariance of between factors and exogenous within factors to 0 \n  RIX + RIY + RIX1 + RIX2 + RIX3 + RIY1 + RIY2 + RIY3 ~~ 0*WFY1 + 0*WFX1\n'\nRICLPM4.ext3.fit &lt;- cfa(RICLPM4.ext3, \n  data = datMI, \n  missing = 'ML'\n)\nsummary(RICLPM4.ext3.fit, standardized = T)\n\n\n\nMultiple indicator RI-CLPM, 5 waves with 3 indicators for each variable at each wave (30 observed variables). Fitting a model with constraints to ensure strong factorial invariance, with the RI-CLPM at the latent level.\n\nRICLPM5.ext3 &lt;- '\n  \n  #####################\n  # MEASUREMENT MODEL #\n  #####################\n  \n  # Factor models for X at 5 waves (constrained)\n  FX1 =~ a*x11 + b*x12 + c*x13\n  FX2 =~ a*x21 + b*x22 + c*x23\n  FX3 =~ a*x31 + b*x32 + c*x33\n  FX4 =~ a*x41 + b*x42 + c*x43\n  FX5 =~ a*x51 + b*x52 + c*x53\n  \n  # Factor models for Y at 5 waves (constrained)\n  FY1 =~ d*y11 + e*y12 + f*y13\n  FY2 =~ d*y21 + e*y22 + f*y23\n  FY3 =~ d*y31 + e*y32 + f*y33\n  FY4 =~ d*y41 + e*y42 + f*y43\n  FY5 =~ d*y51 + e*y52 + f*y53\n  \n  # Constrained intercepts over time (this is necessary for strong factorial \n  # invariance; without these contraints we have week factorial invariance)\n  x11 + x21 + x31 + x41 + x51 ~ g*1\n  x12 + x22 + x32 + x42 + x52 ~ h*1\n  x13 + x23 + x33 + x43 + x53 ~ i*1\n  y11 + y21 + y31 + y41 + y51 ~ j*1\n  y12 + y22 + y32 + y42 + y52 ~ k*1\n  y13 + y23 + y33 + y43 + y53 ~ l*1\n  \n  # Free latent means from t = 2 onward (only do this in combination with \n  # constraints on intercepts; without these, this would not be identified)\n  FX2 + FX3 + FX4 + FX5 + FY2 + FY3 + FY4 + FY5 ~ 1\n  \n  ################\n  # BETWEEN PART #\n  ################\n  \n  # Create between factors (random intercepts)\n  RIX =~ 1*FX1 + 1*FX2 + 1*FX3 + 1*FX4 + 1*FX5\n  RIY =~ 1*FY1 + 1*FY2 + 1*FY3 + 1*FY4 + 1*FY5\n  \n  # Set residual variances of all FX and FY variables to 0\n  FX1 ~~ 0*FX1\n  FX2 ~~ 0*FX2\n  FX3 ~~ 0*FX3\n  FX4 ~~ 0*FX4\n  FX5 ~~ 0*FX5\n  FY1 ~~ 0*FY1\n  FY2 ~~ 0*FY2\n  FY3 ~~ 0*FY3\n  FY4 ~~ 0*FY4\n  FY5 ~~ 0*FY5\n  \n  ###############\n  # WITHIN PART #\n  ###############\n \n  # Create within-components\n  WFX1 =~ 1*FX1\n  WFX2 =~ 1*FX2\n  WFX3 =~ 1*FX3\n  WFX4 =~ 1*FX4\n  WFX5 =~ 1*FX5\n  \n  WFY1 =~ 1*FY1\n  WFY2 =~ 1*FY2\n  WFY3 =~ 1*FY3\n  WFY4 =~ 1*FY4\n  WFY5 =~ 1*FY5\n  \n  # Specify lagged effects between within-person centered latent variables\n  WFX2 + WFY2 ~ WFX1 + WFY1\n  WFX3 + WFY3 ~ WFX2 + WFY2\n  WFX4 + WFY4 ~ WFX3 + WFY3\n  WFX5 + WFY5 ~ WFX4 + WFY4\n  \n  # Estimate correlations within same wave\n  WFX2 ~~ WFY2\n  WFX3 ~~ WFY3 \n  WFX4 ~~ WFY4\n  WFX5 ~~ WFY5\n  \n  ##########################\n  # ADDITIONAL CONSTRAINTS #\n  ##########################\n  \n  # Set correlations between between-factors (random intercepts) and within-\n  # factors at wave 1 at 0\n  RIX + RIY ~~ 0*WFX1 + 0*WFY1\n'\nRICLPM5.ext3.fit &lt;- cfa(RICLPM5.ext3,\n  data = datMI, \n  missing = 'ML'\n)\nsummary(RICLPM5.ext3.fit, standardized = T)\n\n\n\n\n\n\n\\(\\bar{\\chi}^{2}\\)-test\nThe use of the chi-square difference test is wide-spread in the SEM community to test constraints on parameters. However, when constraints are placed on the bound of the parameter space, we should use the chi-bar-square test (\\(\\bar{\\chi}^{2}\\)-test) (Stoel et al. 2006). For example, if we constrain the variances of all random intercepts (and their covariance) in the RI-CLPM to zero, we obtain a model that is nested under the RI-CLPM, and that is statistically equivalent to the traditional cross-lagged panel model (CLPM). Below you can find R code for performing the chi-bar-square test (code by Rebecca M. Kuiper) for comparing these two models. It involves\n\nfitting both the RI-CLPM (RICLPM.fit) and CLPM (CLPM.fit);\nextracting the covariance matrix of the random intercepts;\nextracting the \\(\\chi^{2}\\) and degrees of freedom of both models; and\nperforming the \\(\\bar{\\chi}^{2}\\)-test using the ChiBarSq.DiffTest package (Kuiper 2020).\n\n\n# Install and load required packages\n## library(devtools)\n## install_github(\"rebeccakuiper/ChiBarSq.DiffTest\")\nlibrary(ChiBarSq.DiffTest)\n\n# Step 1: Fit RI-CLPM (RICLPM.fit) and CLPM (CLPM.fit)\n\n# Step 2: Find indices needed for covariance matrix of random intercepts\nvcov(RICLPM.fit) # Full covariance matrix\nindices &lt;- c(22, 23) # The 22nd and 23rd indices regard random intercepts\nq &lt;- length(indices) # Number of random intercepts\nS &lt;- vcov(RICLPM.fit)[indices, indices] # Extract covariance matrix of random intercepts\n\n# Step 3: Extract Chi-square and degrees of freedom\nChi2_clpm &lt;- summary(CLPM.fit, fit.measures = TRUE)[1]$FIT[c(\"chisq\")] \nChi2_riclpm &lt;- summary(RICLPM.fit, fit.measures = TRUE)[1]$FIT[c(\"chisq\")]\n\ndf_clpm &lt;- summary(CLPM.fit, fit.measures = TRUE)[1]$FIT[c(\"df\")]\ndf_riclpm &lt;- summary(RICLPM.fit, fit.measures = TRUE)[1]$FIT[c(\"df\")]\n\n# Step 4: Perform Chi-bar-square test (and obtain Chi-bar-square weights)\nChiBar2DiffTest &lt;- ChiBarSq.DiffTest(q, S, Chi2_clpm, Chi2_riclpm, df_clpm, df_riclpm)\nChiBar2DiffTest\nChiBar2DiffTest$p_value\n\n&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD\n\n\n\nGORICA\nRather than evaluating a null-hypothesis of no effect, researchers may be interested in evaluating a theory-based, informative hypothesis (Altinisik et al. 2021). Informative hypotheses can reflect a priori theories, and often contain orderings of (standardized) parameters. For example, one may hypothesize that one cross-lagged relationship is higher than another one; often referred to as “causal dominance”. Such a causal dominance hypothesis can be evaluated with an AIC-type criterion called the GORICA (Sukpan and Kuiper 2023). Below you find code for evaluating a causal dominance hypothesis using the GORICA, for both the RI-CLPM with time-independent and time-specific parameters. We make use of the example data provided with these online supplementary materials. For more information, we refer to https://github.com/rebeccakuiper/Tutorials.\n::: {.panel-tabset}\n\n\n### Time-varying lagged-effects\n\n\nGORICA\nRather than evaluating a null-hypothesis of no effect, researchers may be interested in evaluating a theory-based, informative hypothesis (Altinisik et al. 2021). Informative hypotheses can reflect a priori theories, and often contain orderings of (standardized) parameters. For example, one may hypothesize that one cross-lagged relationship is higher than another one; often referred to as “causal dominance”. Such a causal dominance hypothesis can be evaluated with an AIC-type criterion called the GORICA (Sukpan and Kuiper 2023). Below you find code for evaluating a causal dominance hypothesis using the GORICA, for both the RI-CLPM with time-independent and time-specific parameters. We make use of the example data provided with these online supplementary materials. For more information, we refer to https://github.com/rebeccakuiper/Tutorials.\n\nTime-varying lagged-effects\n\n\n\n\n\n\n\n\n\nd862b70c06b0a1bfbd01f9450f9c709375a1c132 In the below R code, we use the GORICA to test the informative hypothesis that the cross-lagged effects from \\(X\\) to \\(Y\\) are stronger than those from \\(Y\\) to \\(X\\) (i.e., \\(X\\) is causally dominant). For the specification of this hypothesis we need to label the cross-lagged parameters, which in the below model specification are allowed to vary over time. Analysis using the GORICA shows that the informative hypothesis has 13.137 times more support than its complement (i.e., that there is no causal dominance, or that \\(Y\\) is causally dominant).\n\n\n\n\n\n\n\n\n# R package for testing of linear (in)equality restrictions on parameters in linear models\nlibrary(restriktor)\n\n# Informative hypothesis about cross-lagged effects (using parameter labels in model)\nH1 &lt;- \"abs(b2) &lt; abs(c2); abs(b3) &lt; abs(c3); \n       abs(b4) &lt; abs(c4); abs(b5) &lt; abs(c5)\" \n\n# Fit RI-CLPM\nRICLPM_H1 &lt;- '\n  # Create between components (random intercepts)\n  RIx =~ 1*x1 + 1*x2 + 1*x3 + 1*x4 + 1*x5\n  RIy =~ 1*y1 + 1*y2 + 1*y3 + 1*y4 + 1*y5\n  \n  # Create within-person centered variables\n  wx1 =~ 1*x1\n  wx2 =~ 1*x2\n  wx3 =~ 1*x3 \n  wx4 =~ 1*x4\n  wx5 =~ 1*x5\n  \n  wy1 =~ 1*y1\n  wy2 =~ 1*y2\n  wy3 =~ 1*y3\n  wy4 =~ 1*y4\n  wy5 =~ 1*y5\n\n  # Estimate lagged effects between within-person centered variables\n  wx2 ~ a2*wx1 + b2*wy1 \n  wy2 ~ c2*wx1 + d2*wy1\n  \n  wx3 ~ a3*wx2 + b3*wy2\n  wy3 ~ c3*wx2 + d3*wy2\n  \n  wx4 ~ a4*wx3 + b4*wy3\n  wy4 ~ c4*wx3 + d4*wy3\n  \n  wx5 ~ a5*wx4 + b5*wy4\n  wy5 ~ c5*wx4 + d5*wy4\n\n  # Estimate covariance between within-person centered variables at first wave\n  wx1 ~~ wy1 # Covariance\n  \n  # Estimate covariances between residuals of within-person centered variables \n  # (i.e., innovations)\n  wx2 ~~ wy2\n  wx3 ~~ wy3\n  wx4 ~~ wy4\n  wx5 ~~ wy5\n  \n  # Estimate variance and covariance of random intercepts\n  RIx ~~ RIx\n  RIy ~~ RIy\n  RIx ~~ RIy\n\n  # Estimate (residual) variance of within-person centered variables\n  wx1 ~~ wx1 # Variances\n  wy1 ~~ wy1 \n  wx2 ~~ wx2 # Residual variances\n  wy2 ~~ wy2 \n  wx3 ~~ wx3 \n  wy3 ~~ wy3 \n  wx4 ~~ wx4 \n  wy4 ~~ wy4 \n  wx5 ~~ wx5\n  wy5 ~~ wy5\n'\n\nfit_H1 &lt;- lavaan(\n  model = RICLPM_H1,\n  data = dat, \n  missing = \"ML\", \n  meanstructure = TRUE, \n  int.ov.free = TRUE\n)\n\nsummary(fit_H1, standardized = TRUE)\n\n# Compute GORICA values and weights (use `standardized = TRUE`)\nGORICA_H1 &lt;- goric(\n  fit_H1, \n  standardized = TRUE,\n  hypotheses = list(H1ws.l = H1), \n  comparison = \"complement\", # Test informative hypothesis versus its complement\n  type = \"gorica\"\n)\n\nGORICA_H1\n\n&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD ### Constrained parameters ======= ## Constrained parameters &gt;&gt;&gt;&gt;&gt;&gt;&gt; d862b70c06b0a1bfbd01f9450f9c709375a1c132 The GORICA can also be used to test informative hypotheses when parameters are constrained over time. In the below R code, the lagged effects, residuals variances, and intercepts are restricted to be time-invariant. We again use the GORICA to test the informative hypothesis that the cross-lagged effects from \\(X\\) to \\(Y\\) are stronger than those from \\(Y\\) to \\(X\\) (i.e., \\(X\\) is causally dominant). Analysis shows that the informative hypothesis has 785.564 times more support than its complement. (i.e., that there is no causal dominance, or that \\(Y\\) is causally dominant).\n\n# Informative hypothesis about time-invariant cross-lagged effects \nH2 &lt;- \"abs(b) &lt; abs(c)\" \n\n# Fit RI-CLPM\nRICLPM_H2 &lt;- '\n  # Create between components (random intercepts)\n  RIx =~ 1*x1 + 1*x2 + 1*x3 + 1*x4 + 1*x5\n  RIy =~ 1*y1 + 1*y2 + 1*y3 + 1*y4 + 1*y5\n  \n  # Create within-person centered variables\n  wx1 =~ 1*x1\n  wx2 =~ 1*x2\n  wx3 =~ 1*x3 \n  wx4 =~ 1*x4\n  wx5 =~ 1*x5\n  wy1 =~ 1*y1\n  wy2 =~ 1*y2\n  wy3 =~ 1*y3\n  wy4 =~ 1*y4\n  wy5 =~ 1*y5\n  \n  # Estimate lagged effects between within-person centered variables \n  # (constrained)\n  wx2 ~ a*wx1 + b*wy1 \n  wy2 ~ c*wx1 + d*wy1\n  wx3 ~ a*wx2 + b*wy2\n  wy3 ~ c*wx2 + d*wy2\n  wx4 ~ a*wx3 + b*wy3\n  wy4 ~ c*wx3 + d*wy3\n  wx5 ~ a*wx4 + b*wy4\n  wy5 ~ c*wx4 + d*wy4\n  \n  # Estimate covariances between residuals of within-person centered variables \n  # (i.e., innovations, constrained)\n  wx2 ~~ cov*wy2\n  wx3 ~~ cov*wy3\n  wx4 ~~ cov*wy4 \n  wx5 ~~ cov*wy5\n  \n  # Estimate covariance between within-person centered variables at first wave\n  wx1 ~~ wy1 # Covariance\n  \n  # Estimate variance and covariance of random intercepts\n  RIx ~~ RIx\n  RIy ~~ RIy\n  RIx ~~ RIy\n  \n  # Estimate (residual) variance of within-person centered variables \n  # (constrained)\n  wx1 ~~ wx1 # Variance\n  wy1 ~~ wy1 \n  wx2 ~~ vx*wx2 # Residual variance\n  wy2 ~~ vy*wy2 \n  wx3 ~~ vx*wx3 \n  wy3 ~~ vy*wy3 \n  wx4 ~~ vx*wx4 \n  wy4 ~~ vy*wy4 \n  wx5 ~~ vx*wx5\n  wy5 ~~ vy*wy5\n  \n  # Constrain grand means over time\n  x1 + x2 + x3 + x4 + x5 ~ mx*1\n  y1 + y2 + y3 + y4 + y5 ~ my*1\n'\n\nfit_H2 &lt;- lavaan(\n  model = RICLPM_H2,\n  data = dat, \n  missing = \"ML\", \n  meanstructure = TRUE, \n  int.ov.free = TRUE\n)\n\nsummary(fit_H2, standardized = TRUE)\n\n# Compute GORICA values and weights\nGORICA_H2 &lt;- goric(\n  fit_H2, \n  hypotheses = list(H2), \n  comparison = \"complement\", # Test informative hypothesis versus its complement\n  type = \"gorica\"\n)\n\nGORICA_H2\n\n&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD\n\n\n\n======= &gt;&gt;&gt;&gt;&gt;&gt;&gt; d862b70c06b0a1bfbd01f9450f9c709375a1c132\n\n\n\n\n\nReferences\n\nAltinisik, Yasin, Caspar J. Van Lissa, Herbert Hoijtink, Albertine J. Oldehinkel, and Rebecca M. Kuiper. 2021. “Evaluation of Inequality Constrained Hypotheses Using a Generalization of the AIC.” Psychological Methods 26 (5): 599–621. https://doi.org/10.1037/met0000406.\n\n\nKuiper, Rebecca M. 2020. ChiBarSq.DiffTest: Chi-bar-square difference test of the RI-CLPM versus the CLPM and more general.\n\n\nRosseel, Yves. 2012. “lavaan: An R Package for Structural Equation Modeling.” Journal of Statistical Software 48 (2): 1–36. http://www.jstatsoft.org/v48/i02/.\n\n\nStoel, Reinoud D., Francisca Galindo Garre, Conor Dolan, and Godfried van den Wittenboer. 2006. “On the likelihood ratio test in structural equation modeling when parameters are subject to boundary constraints.” Psychological Methods 11 (4): 439–55. https://doi.org/10.1037/1082-989X.11.4.439.\n\n\nSukpan, Chuenjai, and Rebecca M. Kuiper. 2023. “How to Evaluate Causal Dominance Hypotheses in Lagged Effects Models.” Structural Equation Modeling: A Multidisciplinary Journal 0 (0): 1–16. https://doi.org/10.1080/10705511.2023.2265065."
  },
  {
    "objectID": "mplus.html",
    "href": "mplus.html",
    "title": "Using Mplus",
    "section": "",
    "text": "For Mplus (Muthén and Muthén 2017) to work properly, make sure that you save the input file with the model specification (example.inp) in the same folder as the data (example.dat). You can download the simulated example datasets here. Mplus includes defaults, like that:\n\nobserved and latent exogenous variables are correlated, and\nresiduals of observed and latent outcome variables (which do not predict anything) in a path model are correlated.\n\nThese defaults are included to make the specification of many standard SEM models easier, but they are not always useful in the current modeling context. Therefore, we use the command ANALYSIS: MODEL = NOCOV; to overrule these defaults for the covariances and set all of them to zero.\n\n\n\n\n\n\nMplus residual language\n\n\n\nFrom Mplus version 8.7 onward, the Residual Structural Equation Modeling (RSEM) capabilities have been expanded (Asparouhov and Muthén 2021). This allows for considerably simpler model syntax for the RI-CLPM using the ^ command. You can find Mplus syntax using this alternative hats-notation for the basic RI-CLPM (both with and without constraints over time) in the Residual syntax section.\n\n\n\nThe RI-CLPM\nTo specify the RI-CLPM we need four parts.\n\nA between part, consisting of the random intercepts. It is specified using the BY command, RIx BY x1@1 x2@1 ...;, where @1 fixes the factor loading to one.\nA within part, consisting of within-unit fluctuations. It is also specified using the BY command, wx1 BY x1; wx2 BY x2; .... We do not have to constrain the factor loading to 1, as this is already the default in Mplus for the factor loading of the first indicator of a latent variable. However, we do need to constrain the measurement error variances to zero, as Mplus will include them by default when we use the BY statement. We do this by including x1@0 x2@0 x3@0 x4@0 x5@0; where @0 fixes the measurement error variances to zero, which is the same as saying there is no measurement error.\nThe lagged regressions between the within-unit components, using wx2 ON wx1 wy1; wx3 ON wx2 wy2; ....\nRelevant covariances in both the between and within part. In the within part the components at wave 1, and their residuals at waves 2 and further are correlated within each wave, using wx1 WITH wy1; wx2 WITH wy2;.... For the between part we have to specify that the random intercepts are correlated using RIx WITH RIy;.\n\n\nBasic modelConstraints over timeConstrain standardized lagged effects\n\n\nThe syntax for specifying the basic RI-CLPM is given below.\nTITLE:      The basic RI-CLPM, 5 waves. \n       \nDATA:       FILE = RICLPM.dat;\n                    \nVARIABLE:   NAMES = x1-x5 y1-y5;\n    \nANALYSIS:   MODEL = NOCOV; ! Sets all default covariances to zero\n        \nMODEL:      ! Create between components (random intercepts)\n            RIx BY x1@1 x2@1 x3@1 x4@1 x5@1;\n            RIy BY y1@1 y2@1 y3@1 y4@1 y5@1;\n        \n            ! Create within-person centered variables\n            wx1 BY x1@1; \n            wx2 BY x2@1;\n            wx3 BY x3@1; \n            wx4 BY x4@1; \n            wx5 BY x5@1;\n            \n            wy1 BY y1@1; \n            wy2 BY y2@1;\n            wy3 BY y3@1; \n            wy4 BY y4@1; \n            wy5 BY y5@1;\n    \n            ! Constrain measurement error variances to 0\n            x1-y5@0;\n    \n            ! Estimate lagged effects between within-person centered variables\n            wx2 wy2 ON wx1 wy1;\n            wx3 wy3 ON wx2 wy2;\n            wx4 wy4 ON wx3 wy3;\n            wx5 wy5 ON wx4 wy4;\n    \n            ! Estimate covariance between random intercepts\n            RIx WITH RIy;\n    \n            ! Estimate covariance between within-person components at first wave\n            wx1 WITH wy1;\n                \n            ! Estimate covariances between residuals of within-person components \n            ! (i.e., innovations)\n            wx2 WITH wy2;\n            wx3 WITH wy3; \n            wx4 WITH wy4;\n            wx5 WITH wy5; \n                \nOUTPUT:     TECH1 STDYX SAMPSTAT CINTERVAL;\n\n\nImposing constraints to the model can be achieved by giving labels to parameters and using the same label for parameters that you want to constrain to be equal. A label is specified by adding (label) after a parameter. Below we specify a RI-CLPM with the following constraints:\n\nfixed auto-regressive and cross-lagged relations over time, (a b c d),\ntime-invariant (residual) (co-)variances in the within-person part (cov), (vx), and (vy), and\nconstrained grand means over time, (mx) and (my).\n\nTITLE:      The basic RI-CLPM, 5 waves. \n            Constrain the grand means, (residual) variances, and \n            lagged effects over time.   \n    \nDATA:       FILE = RICLPM.dat;  \n                \nVARIABLE:   NAMES = x1-x5 y1-y5;\n    \nANALYSIS:   MODEL = NOCOV; ! Sets all default covariances to zero\n        \nMODEL:      ! Create between components (random intercepts)\n            RIx BY x1@1 x2@1 x3@1 x4@1 x5@1;\n            RIy BY y1@1 y2@1 y3@1 y4@1 y5@1;\n      \n            ! Create within-person centered variables\n            wx1 BY x1@1; \n            wx2 BY x2@1;\n            wx3 BY x3@1; \n            wx4 BY x4@1; \n            wx5 BY x5@1;\n                \n            wy1 BY y1@1; \n            wy2 BY y2@1;\n            wy3 BY y3@1; \n            wy4 BY y4@1; \n            wy5 BY y5@1;\n    \n            ! Constrain measurement error variances to 0\n            x1-y5@0;\n    \n            ! Estimate lagged effects between within-person centered variables\n            wx2 wy2 ON wx1 wy1 (a b c d);\n            wx3 wy3 ON wx2 wy2 (a b c d);\n            wx4 wy4 ON wx3 wy3 (a b c d);\n            wx5 wy5 ON wx4 wy4 (a b c d);\n  \n            ! Estimate covariance between random intercepts\n            RIx WITH RIy;\n    \n            ! Estimate covariance between within-person components at the first wave\n            wx1 WITH wy1;\n                \n            ! Estimate covariances between residuals of within-person components \n            ! (i.e., innovations) and constrain these and residual variances to be \n            ! invariant over time\n            wx2 WITH wy2 (cov); wx2 (vx); wy2 (vy);\n            wx3 WITH wy3 (cov); wx3 (vx); wy3 (vy);\n            wx4 WITH wy4 (cov); wx4 (vx); wy4 (vy); \n            wx5 WITH wy5 (cov); wx5 (vx); wy5 (vy);\n\n            ! Constrain grand means to be invariant over time\n            [x1 x2 x3 x4 x5] (mx);\n            [y1 y2 y3 y4 y5] (my);\n                \nOUTPUT:     TECH1 STDYX SAMPSTAT CINTERVAL;\n\n\nRather than imposing constraints on the unstandardized auto-regressive and cross-lagged relations over time, we can impose constraints on the standardized lagged effects, as explained in the FAQ. Compared to the basic model, there are multiple changes to the syntax. First, we freely estimate the factor loadings that link the observed variables to the within-components, rather than fixing them to 1:\n! Create within-components with freely estimated factor loadings\nwx1 BY x1*; \nwx2 BY x2*;\nwx3 BY x3*; \nwx4 BY x4*; \nwx5 BY x5*;\n                \nwy1 BY y1*; \nwy2 BY y2*;\nwy3 BY y3*; \nwy4 BY y4*; \nwy5 BY y5*;\nSecond, we set the variances of within-components at first wave to 1, and label the covariance (now also the correlation) between them:\n! Set variances of within-components at first wave to 1\nwx1@1 wy1@1;\n\n! Estimate correlation between within-components at first wave\nwx1 WITH wy1 (cor1);\nThird, we give the residual variance and covariances between the within-component each a unique label:\nwx2 WITH wy2 (rcov2); wx2 (rvx2); wy2 (rvy2);\nwx3 WITH wy3 (rcov3); wx3 (rvx3); wy3 (rvy3);\nwx4 WITH wy4 (rcov4); wx4 (rvx4); wy4 (rvy4); \nwx5 WITH wy5 (rcov5); wx5 (rvx5); wy5 (rvy5);\nFinally, we compute the correlations between the within-components themselves at each wave, and then constrain the residual variances to ensure that the total variance of each within-component equals 1. This is done in the MODEL CONSTRAINT command:\nMODEL CONSTRAINT:\n  ! Compute correlations of within-components at each wave\n  NEW(cor2);\n  NEW(cor3);\n  NEW(cor4);\n  \n  cor2 = a*c + b*d + a*d*cor1 + b*c*cor1 + rcov2;\n  cor3 = a*c + b*d + a*d*cor2 + b*c*cor2 + rcov3;\n  cor4 = a*c + b*d + a*d*cor3 + b*c*cor3 + rcov4;\n \n  ! Contrain residual variances of within-components such that variance of each \n  ! within-component equals 1\n  rvx2 = 1 - (a*a + b*b + 2*a*b*cor1);\n  rvy2 = 1 - (c*c + d*d + 2*c*d*cor1);\n  rvx3 = 1 - (a*a + b*b + 2*a*b*cor2);\n  rvy3 = 1 - (c*c + d*d + 2*c*d*cor2);\n  rvx4 = 1 - (a*a + b*b + 2*a*b*cor3);\n  rvy4 = 1 - (c*c + d*d + 2*c*d*cor3);\n  rvx5 = 1 - (a*a + b*b + 2*a*b*cor4);\n  rvy5 = 1 - (c*c + d*d + 2*c*d*cor4);\n\n\n\n\n\nExtension 1: Including time-invariant predictors and outcomes\nUse the tabs below to navigate to the model specification of the RI-CLPM with\n\na time-invariant predictor \\(z_{1}\\) of the observed variables (\\(z_{1}\\) \\(\\rightarrow\\) observed),\na time-invariant predictor \\(z_{1}\\) of the random intercepts (\\(z_{1}\\) \\(\\rightarrow\\) RIs),\nrandom intercepts predicting a time-invariant outcome \\(z_{2}\\) (RIs \\(\\rightarrow\\) \\(z_{2}\\)), or\nwithin components predicting a time-invariant outcome \\(z_{2}\\) (within \\(\\rightarrow\\) \\(z_{2}\\)).\n\n\n\\(z_{1}\\) \\(\\rightarrow\\) observed\\(z_{1}\\) \\(\\rightarrow\\) RIsRIs \\(\\rightarrow\\) \\(z_{2}\\)within \\(\\rightarrow\\) \\(z_{2}\\)\n\n\nBelow you can find the syntax for a RI-CLPM with 5 waves and a time-invariant predictor \\(z_{1}\\) for the observed variables. The effect of \\(z_{1}\\) on the observed variables is constrained to be the same across waves.\nTITLE:      RI-CLPM, 5 waves, including a time-invariant predictor for\n            the observed variables. \n       \nDATA:       FILE = RICLPM-Z.dat;\n                \nVARIABLE:   NAMES = x1-x5 y1-y5 z2 z1;\n            USEVARIABLES = x1-y5 z1;\n        \nANALYSIS:   MODEL = NOCOV; ! Sets all default covariances to zero\n        \nMODEL:      ! Create between components (random intercepts)\n            RIx BY x1@1 x2@1 x3@1 x4@1 x5@1;\n            RIy BY y1@1 y2@1 y3@1 y4@1 y5@1;\n    \n            ! Estimate covariance between random intercepts\n            RIx WITH RIy;\n    \n            ! Create within-person centered variables\n            wx1 BY x1@1; \n            wx2 BY x2@1;\n            wx3 BY x3@1; \n            wx4 BY x4@1;\n            wx5 BY x5@1;\n    \n            wy1 BY y1@1; \n            wy2 BY y2@1;\n            wy3 BY y3@1; \n            wy4 BY y4@1;\n            wy5 BY y5@1;\n\n            ! Constrain measurement error variances to 0\n            x1-y5@0;\n\n            ! Regression of observed variables on z1 (unconstrained)\n            x1-x5 ON z1 (s1);\n            y1-y5 ON z1 (s2);\n\n            ! Estimate lagged effects between within-person centered variables\n            wx2 wy2 ON wx1 wy1;\n            wx3 wy3 ON wx2 wy2;\n            wx4 wy4 ON wx3 wy3;\n            wx5 wy5 ON wx4 wy4;\n\n            ! Estimate covariance between within-person components at first wave \n            wx1 WITH wy1;\n           \n            ! Estimate covariances between residuals of within-person components \n            ! (i.e., innovations)\n            wx2 WITH wy2;\n            wx3 WITH wy3; \n            wx4 WITH wy4; \n            wx5 WITH wy5;\n  \nOUTPUT:     TECH1 STDYX SAMPSTAT CINTERVAL;\n\n\nBelow you can find the syntax for a RI-CLPM with 5 waves and a time-invariant predictor \\(z_{1}\\) for the random intercepts.\nTITLE:      RI-CLPM, 5 waves, including a time-invariant predictor for\n            the random intercepts. \n       \nDATA:       FILE = RICLPM-Z.dat;\n                  \nVARIABLE:   NAMES = x1-x5 y1-y5 z2 z1;\n            USEVARIABLES = x1-y5 z1;\n        \nANALYSIS:   MODEL = NOCOV; ! Sets all default covariances to zero\n        \nMODEL:      ! Create between components (random intercepts)\n            RIx BY x1@1 x2@1 x3@1 x4@1 x5@1;\n            RIy BY y1@1 y2@1 y3@1 y4@1 y5@1;\n    \n            ! Estimate covariance between random intercepts\n            RIx WITH RIy;\n    \n            ! Create within-person centered variables\n            wx1 BY x1@1; \n            wx2 BY x2@1;\n            wx3 BY x3@1; \n            wx4 BY x4@1;\n            wx5 BY x5@1;\n\n            wy1 BY y1@1; \n            wy2 BY y2@1;\n            wy3 BY y3@1; \n            wy4 BY y4@1;\n            wy5 BY y5@1;\n    \n            ! Constrain measurement error variances to 0\n            x1-y5@0;\n    \n            ! Regression of random intercepts on z1\n            RIx RIy ON z1;\n    \n            ! Estimate lagged effects between within-person centered variables\n            wx2 wy2 ON wx1 wy1;\n            wx3 wy3 ON wx2 wy2;\n            wx4 wy4 ON wx3 wy3;\n            wx5 wy5 ON wx4 wy4;\n  \n            ! Estimate covariance between within-person components at first wave \n            wx1 WITH wy1;\n               \n            ! Estimate covariances between residuals of within-person components \n            ! (i.e., innovations)\n            wx2 WITH wy2;\n            wx3 WITH wy3; \n            wx4 WITH wy4; \n            wx5 WITH wy5;\n  \nOUTPUT:     TECH1 STDYX SAMPSTAT CINTERVAL;\n\n\nBelow you can find the syntax for a RI-CLPM with 5 waves and the random intercepts predicting the time-invariant outcome \\(z_{2}\\).\nTITLE:      RI-CLPM, 5 waves.\n              Time-invariant predictor z1 for observed variables (constrained).\n              Between components predicting time-invariant outcome z2.\n       \nDATA:       FILE = RICLPM-Z.dat;\n                  \nVARIABLE:   NAMES = x1-x5 y1-y5 z2 z1;\n        \nANALYSIS:   MODEL = NOCOV; ! Sets all default covariances to zero\n    \nMODEL:      ! Create between components (random intercepts)\n            RIx BY x1@1 x2@1 x3@1 x4@1 x5@1;\n            RIy BY y1@1 y2@1 y3@1 y4@1 y5@1;\n    \n            ! Estimate covariance between random intercepts\n            RIx WITH RIy;\n    \n            ! Regres distal outcome on random intercepts\n            z2 ON RIx RIy;\n                \n            ! Create within-person centered variables\n            wx1 BY x1@1; \n            wx2 BY x2@1;\n            wx3 BY x3@1; \n            wx4 BY x4@1;\n            wx5 BY x5@1;\n  \n            wy1 BY y1@1; \n            wy2 BY y2@1;\n            wy3 BY y3@1; \n            wy4 BY y4@1;\n            wy5 BY y5@1;\n    \n            ! Constrain measurement error variances to 0\n            x1-y5@0;\n  \n            ! Regression of observed variables on z1 (constrained)\n            x1-x5 ON z1 (s1);\n            y1-y5 ON z1 (s2);\n    \n            ! Estimate lagged effects between within-person centered variables\n            wx2 wy2 ON wx1 wy1;\n            wx3 wy3 ON wx2 wy2;\n            wx4 wy4 ON wx3 wy3;\n            wx5 wy5 ON wx4 wy4;\n    \n            ! Estimate covariance between within-person components at first wave \n            wx1 WITH wy1;\n           \n            ! Estimate covariances between residuals of within-person components \n            ! (i.e., innovations)\n            wx2 WITH wy2;\n            wx3 WITH wy3; \n            wx4 WITH wy4; \n            wx5 WITH wy5;\n    \nOUTPUT:     TECH1 STDYX SAMPSTAT CINTERVAL;\n\n\nBelow you can find the syntax for a RI-CLPM with 5 waves and the within components predicting the time-invariant outcome \\(z_{2}\\).\nTITLE:      RI-CLPM, 5 waves\n              Time-invariant predictor z1 for observed variables (constrained).\n              Within components predicting time-invariant outcome z2.\n       \nDATA:       FILE = RICLPM-Z.dat;\n                  \nVARIABLE:   NAMES = x1-x5 y1-y5 z2 z1;\n    \nANALYSIS:   MODEL = NOCOV; ! Sets all default covariances to zero\n    \nMODEL:      ! Create between-components (random intercepts)\n            RIx BY x1@1 x2@1 x3@1 x4@1 x5@1;\n            RIy BY y1@1 y2@1 y3@1 y4@1 y5@1;\n\n            ! Estimate covariance between random intercepts\n            RIx WITH RIy;\n    \n            ! Create within-person centered variables\n            wx1 BY x1@1; \n            wx2 BY x2@1;\n            wx3 BY x3@1; \n            wx4 BY x4@1;\n            wx5 BY x5@1;\n    \n            wy1 BY y1@1; \n            wy2 BY y2@1;\n            wy3 BY y3@1; \n            wy4 BY y4@1;\n            wy5 BY y5@1;\n    \n            ! Constrain measurement error variances to 0\n            x1-y5@0;\n\n              ! Regres distal outcome on within components\n            z2 ON wx1-wx5 wy1-wy5;\n            \n            ! Regression of observed variables on z1 (constrained)\n            x1-x5 ON z1 (s1);\n            y1-y5 ON z1 (s2);\n\n            ! Estimate lagged effects between within-person centered variables\n            wx2 wy2 ON wx1 wy1;\n            wx3 wy3 ON wx2 wy2;\n            wx4 wy4 ON wx3 wy3;\n            wx5 wy5 ON wx4 wy4;\n    \n            ! Estimate covariance between within-person components at first wave \n            wx1 WITH wy1;\n               \n            ! Estimate covariances between residuals of within-person components \n            ! (i.e., innovations)\n            wx2 WITH wy2;\n            wx3 WITH wy3; \n            wx4 WITH wy4; \n            wx5 WITH wy5;\n  \nOUTPUT:     TECH1 STDYX SAMPSTAT CINTERVAL;\n\n\n\n\n\nExtension 2: Multiple group\nUse the tabs below to navigate to the model specification of the basic multiple-group model, or the model with constrained lagged parameters (and intercepts across groups).\nTo specify a multiple group RI-CLPM, we need to overrule some of the defaults that Mplus will impose and that are associated with multiple group factor analysis. The reason for this is that when we use the BY statement in combination with multiple groups, Mplus will automatically impose the defaults that are associated with strong factorial invariance (Meredith 1993). These defaults are:\n\nequal factor loadings across the groups,\nequal intercepts for the observed variables across the groups, and\nfree latent means in the second (and subsequent) group(s).\n\nIn the context of a multiple-group RI-CLPM, the first constraint is not an issue as all the factor loadings are supposed to be constrained to one in both groups. However, the second constraint on the intercepts and the freeing of the latent means in the second group are not sensible here. There will be fewer observed variables than latent variables defined with a BY statement (i.e., a within-unit part for each observed variable, plus a random intercept for each variable); as a result, we would try to estimate more means than that there were observed. Such a model is unidentified. We should therefore overrule the defaults associated with the mean structure. We do this by adding for the second group [x1 x2 ...]; which frees the intercepts for the observed variables in the second group. Additionally, we include [wx1@0 wx2@0 ... ]; [RIx@0]; for the second group, which ensures all latent means are fixed to zero.\n\nThe basic modelConstrained lagged-parameters\n\n\nBelow you can find the code for a multiple group RI-CLPM with 5 waves.\nTITLE:      Multiple group RI-CLPM, 5 waves. \n            Overruling the Mplus multiple group factor analysis defaults.\n                \nDATA:       FILE = RICLPM-MG.dat;\n                  \nVARIABLE:   NAMES = x1-x5 y1-y5 GROUP;\n            GROUPING = GROUP (1=G1 2=G2);\n        \nANALYSIS:   MODEL = NOCOV; ! Sets all default covariances to zero\n        \nMODEL:      ! Create between components (random intercepts)\n            RIx BY x1@1 x2@1 x3@1 x4@1 x5@1;\n            RIy BY y1@1 y2@1 y3@1 y4@1 y5@1;\n        \n            ! Create within-person centered variables\n            wx1 BY x1@1; \n            wx2 BY x2@1;\n            wx3 BY x3@1; \n            wx4 BY x4@1; \n            wx5 BY x5@1;\n                \n            wy1 BY y1@1; \n            wy2 BY y2@1;\n            wy3 BY y3@1; \n            wy4 BY y4@1; \n            wy5 BY y5@1;\n        \n            ! Constrain measurement error variances to 0\n            x1-y5@0;\n        \n            ! Estimate lagged effects between within-person centered variables\n            wx2 wy2 ON wx1 wy1;\n            wx3 wy3 ON wx2 wy2;\n            wx4 wy4 ON wx3 wy3;\n            wx5 wy5 ON wx4 wy4;\n        \n            ! Estimate covariance between random intercepts\n            RIx WITH RIy;\n        \n            ! Estimate covariance between within-person components at first wave\n            wx1 WITH wy1;\n                    \n            ! Estimate covariances between residuals of within-person components \n            ! (i.e., innovations)\n            wx2 WITH wy2;\n            wx3 WITH wy3; \n            wx4 WITH wy4;\n            wx5 WITH wy5; \n        \nMODEL G2:   ! Overrule multiple group factor analysis default of equal intercepts \n            ! across groups\n            [x1-y5];\n              \n            ! Overrule multiple group factor analysis default of free latent means \n            ! in second group\n            [wx1-wy5@0];\n            [RIx@0 RIy@0];\n                       \nOUTPUT:     TECH1 STDYX SAMPSTAT CINTERVAL;\n\n\nBelow you can find the code for a multiple group RI-CLPM, 5 waves. The lagged-parameters are constrained to be equal over time.\nTITLE:      Multiple group RI-CLPM, 5 waves, with equal lagged parameters \n            across groups. \n            Overruling the Mplus multiple group factor analysis defaults.\n                \nDATA:       FILE = RICLPM-MG.dat;\n                \nVARIABLE:   NAMES = x1-x5 y1-y5 GROUP;\n            GROUPING = GROUP (1=G1 2=G2);\n        \nANALYSIS:   MODEL = NOCOV; ! Sets all default covariances to zero\n    \nMODEL:      ! Create between components (random intercepts)\n            RIx BY x1@1 x2@1 x3@1 x4@1 x5@1;\n            RIy BY y1@1 y2@1 y3@1 y4@1 y5@1;\n    \n            ! Create within-person centered variables\n            wx1 BY x1@1; \n            wx2 BY x2@1;\n            wx3 BY x3@1; \n            wx4 BY x4@1; \n            wx5 BY x5@1;\n                \n            wy1 BY y1@1; \n            wy2 BY y2@1;\n            wy3 BY y3@1; \n            wy4 BY y4@1; \n            wy5 BY y5@1;\n        \n            ! Constrain measurement error variances to 0\n            x1-y5@0;\n        \n            ! Estimate lagged effects between within-person centered variables \n            ! (constrained across groups)\n            wx2 wy2 ON wx1 wy1 (a1 b1 c1 d1);\n            wx3 wy3 ON wx2 wy2 (a2 b2 c2 d2);\n            wx4 wy4 ON wx3 wy3 (a3 b3 c3 d3);\n            wx5 wy5 ON wx4 wy4 (a4 b4 c4 d4);\n        \n            ! Estimate covariance between random intercepts\n            RIx WITH RIy;\n    \n            ! Estimate covariance between within-person components at first wave\n            wx1 WITH wy1;\n                    \n            ! Estimate covariances between residuals of within-person components \n            ! (i.e., innovations)\n            wx2 WITH wy2;\n            wx3 WITH wy3; \n            wx4 WITH wy4;\n            wx5 WITH wy5; \n    \nMODEL G2:   ! Overrule multiple group factor analysis default of equal intercepts \n            ! across groups\n            [x1-y5];\n              \n            ! Overrule multiple group factor analysis default of free latent means \n            ! in second group\n            [wx1-wy5@0];\n            [RIx@0 RIy@0];\n\n            ! Estimate lagged effects between within-person centered variables \n            ! (constrained across groups)\n            wx2 wy2 ON wx1 wy1 (a1 b1 c1 d1);\n            wx3 wy3 ON wx2 wy2 (a2 b2 c2 d2);\n            wx4 wy4 ON wx3 wy3 (a3 b3 c3 d3);\n            wx5 wy5 ON wx4 wy4 (a4 b4 c4 d4);\n                   \nOUTPUT:     TECH1 STDYX SAMPSTAT CINTERVAL;\n\n\n\n\n\nExtension 3: Multiple indicators\nUse the tabs below to navigate to the model specification of a multiple indicator RI-CLPM, 5 waves and 3 indicators for each variable at each wave. The five steps correspond to:\n\nthe configural model (Step 1),\nweak factorial invariance (Step 2),\nstrong factorial invariance (Step 3),\nstrong factorial invariance with factor loadings equal to the within-person factor loadings (Extra), and\nthe latent RI-CLPM (Step 4).\n\n\nStep 1Step 2Step 3ExtraStep 4\n\n\nWhen we have three indicators \\(X\\), measured at five waves, we specify three random intercepts to capture the trait-like part of each indicator, that is, RIX1 BY x11@1 x21@1 ...;, RIX2 BY x12@1 x22@1 ...;, and RIX3 BY x13@1 x23@1 ...;. In addition, we specify five within-unit components that capture the state-like part at each wave, using WFX1 BY x11 x12 x13; WFX2 BY x21 x22 x23; ....\nAt the latent within-unit level, we specify the dynamic model in Mplus usingWFX2 ON WFY1 WFX1; WFX3 ON WFY2 WFX2; .... In addition, we allow the within-person factors at the first wave, and their residuals at subsequent waves to be correlated within each wave, WFX1 WITH WFY1; WFX2 WITH WFY2; .... The six random intercepts are allowed to be freely correlated with each other through RIX1-RIY3 WITH RIX1-RIY3;.\nTITLE:      Multiple indicator RI-CLPM, 5 waves, with 3 indicators for \n            each variable at each wave (30 observed variables) and with \n            random intercepts for each indicator separately.\n    \nDATA:       FILE = RICLPM-MI.dat;\n                \nVARIABLE:   NAMES = x11 x12 x13 x21 x22 x23 x31 x32 x33 \n                    x41 x42 x43 x51 x52 x53 y11 y12 y13 \n                    y21 y22 y23 y31 y32 y33 y41 y42 y43 \n                    y51 y52 y53;\n    \nANALYSIS:   MODEL = NOCOV; ! Sets all default covariances to zero\n    \nMODEL:      \n            !!!!!!!!!!!!!!!!    \n            ! BETWEEN PART !\n            !!!!!!!!!!!!!!!!\n    \n            ! Create between factors (random intercepts) for each indicator separately\n            RIX1 BY x11@1 x21@1 x31@1 x41@1 x51@1;\n            RIX2 BY x12@1 x22@1 x32@1 x42@1 x52@1;\n            RIX3 BY x13@1 x23@1 x33@1 x43@1 x53@1;\n            \n            RIY1 BY y11@1 y21@1 y31@1 y41@1 y51@1;\n            RIY2 BY y12@1 y22@1 y32@1 y42@1 y52@1;\n            RIY3 BY y13@1 y23@1 y33@1 y43@1 y53@1;\n\n            ! Add covariances between all RIs\n            RIX1-RIY3 WITH RIX1-RIY3;\n \n            !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\n            ! WITHIN PART: MEASUREMENT MODEL !\n            !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\n    \n            ! Due to having a random intercept per indicator, the measurement model \n            ! is only on the within part of the measurements\n\n            ! Factor models for X at 5 waves\n            WFX1 BY x11-x13;\n            WFX2 BY x21-x23;\n            WFX3 BY x31-x33;\n            WFX4 BY x41-x43; \n            WFX5 BY x51-x53;   \n            \n            ! Factor models for Y at 5 waves\n            WFY1 BY y11-y13;\n            WFY2 BY y21-y23;\n            WFY3 BY y31-y33;\n            WFY4 BY y41-y43;\n            WFY5 BY y51-y53;\n\n            !!!!!!!!!!!!!!!!!!!!!!!!!\n            ! WITHIN PART: DYNAMICS !\n            !!!!!!!!!!!!!!!!!!!!!!!!!\n\n            ! Specify lagged effects between within-person centered latent variables\n            WFX2 WFY2 ON WFX1 WFY1;\n            WFX3 WFY3 ON WFX2 WFY2;\n            WFX4 WFY4 ON WFX3 WFY3;\n            WFX5 WFY5 ON WFX4 WFY4;\n\n            ! Estimate correlations within same wave\n            WFX1 WITH WFY1;\n            WFX2 WITH WFY2;\n            WFX3 WITH WFY3; \n            WFX4 WITH WFY4;\n            WFX5 WITH WFY5; \n\nOUTPUT:     TECH1 STDYX SAMPSTAT CINTERVAL;\n\n\nIn the second step, we constrain the factor loadings to be invariant over time using the labels (a b) and (c d). We only need to constrain the second and third loading of the factor models at each wave (i.e., WFX1 BY x12 x13, WFX2 BY x22 x23, etc.), because the first loading (i.e., WFX1 BY x11 and WFX2 BY x21, etc.) is constrained to 1 by default, and is therefore already invariant over time.\nTITLE:      Multiple indicator RI-CLPM, 5 waves, with 3 indicators for \n            each variable at each wave (30 observed variables) and with \n            random intercepts for each indicator separately. Fitting a model \n            with constraints to ensure weak factorial invariance. \n  \nDATA:       FILE = RICLPM-MI.dat;\n            \nVARIABLE:   NAMES = x11 x12 x13 x21 x22 x23 x31 x32 x33 \n                    x41 x42 x43 x51 x52 x53 y11 y12 y13 \n                    y21 y22 y23 y31 y32 y33 y41 y42 y43 \n                    y51 y52 y53;\n    \nANALYSIS:   MODEL = NOCOV; ! Sets all default covariances to zero\n\nMODEL:      !!!!!!!!!!!!!!!!    \n            ! BETWEEN PART !\n            !!!!!!!!!!!!!!!!\n\n            ! Create between factors (random intercepts) for each indicator separately\n            RIX1 BY x11@1 x21@1 x31@1 x41@1 x51@1;\n            RIX2 BY x12@1 x22@1 x32@1 x42@1 x52@1;\n            RIX3 BY x13@1 x23@1 x33@1 x43@1 x53@1;\n        \n            RIY1 BY y11@1 y21@1 y31@1 y41@1 y51@1;\n            RIY2 BY y12@1 y22@1 y32@1 y42@1 y52@1;\n            RIY3 BY y13@1 y23@1 y33@1 y43@1 y53@1;\n\n            ! Add covariances between all RIs\n            RIX1-RIY3 WITH RIX1-RIY3;\n\n            !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\n            ! WITHIN PART: MEASUREMENT MODEL !\n            !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\n\n            ! Due to having a random intercept per indicator, the measurement model \n            ! is only on the within part of the measurements\n\n            ! Factor models for X at 5 waves (constrained)\n            WFX1 BY x11-x13 (a b c);\n            WFX2 BY x21-x23 (a b c);\n            WFX3 BY x31-x33 (a b c);\n            WFX4 BY x41-x43 (a b c); \n            WFX5 BY x51-x53 (a b c);   \n            \n            ! Factor models for Y at 5 waves (constrained)\n            WFY1 BY y11-y13 (d e f);\n            WFY2 BY y21-y23 (d e f);\n            WFY3 BY y31-y33 (d e f);\n            WFY4 BY y41-y43 (d e f);\n            WFY5 BY y51-y53 (d e f);\n\n            !!!!!!!!!!!!!!!!!!!!!!!!!\n            ! WITHIN PART: DYNAMICS !\n            !!!!!!!!!!!!!!!!!!!!!!!!!\n\n            ! Specify lagged effects between within-person centered latent variables\n            WFX2 WFY2 ON WFX1 WFY1;\n            WFX3 WFY3 ON WFX2 WFY2;\n            WFX4 WFY4 ON WFX3 WFY3;\n            WFX5 WFY5 ON WFX4 WFY4;\n  \n            ! Estimate correlations within same wave\n            WFX1 WITH WFY1;\n            WFX2 WITH WFY2;\n            WFX3 WITH WFY3; \n            WFX4 WITH WFY4;\n            WFX5 WITH WFY5; \n    \nOUTPUT:     TECH1 STDYX SAMPSTAT CINTERVAL;\n\n\nIn Mplus, the model for strong factorial invariance can be specified as the previous model with the following addition [x11 x12 x13] (g h i);[x21 x22 x23] (g h i); ... which ensures that the intercepts of the observed variables are constrained over time, and [WFX2* WFX3* ... ]; which implies that the latent means at each wave can differ from zero.\nTITLE:      Multiple indicator RI-CLPM, 5 waves, with 3 indicators for \n            each variable at each wave (30 observed variables) and with \n            random intercepts for each indicator separately. Fitting a model \n              with constraints to ensure strong factorial invariance. \n    \nDATA:       FILE = RICLPM-MI.dat;\n            \nVARIABLE:   NAMES = x11 x12 x13 x21 x22 x23 x31 x32 x33 \n                    x41 x42 x43 x51 x52 x53 y11 y12 y13 \n                    y21 y22 y23 y31 y32 y33 y41 y42 y43 \n                    y51 y52 y53;\n    \nANALYSIS:   MODEL = NOCOV; ! Sets all default covariances to zero\n    \nMODEL:      !!!!!!!!!!!!!!!!    \n            ! BETWEEN PART !\n            !!!!!!!!!!!!!!!!\n    \n            ! Create between factors (random intercepts) for each indicator separately\n            RIX1 BY x11@1 x21@1 x31@1 x41@1 x51@1;\n            RIX2 BY x12@1 x22@1 x32@1 x42@1 x52@1;\n            RIX3 BY x13@1 x23@1 x33@1 x43@1 x53@1;\n            \n            RIY1 BY y11@1 y21@1 y31@1 y41@1 y51@1;\n            RIY2 BY y12@1 y22@1 y32@1 y42@1 y52@1;\n            RIY3 BY y13@1 y23@1 y33@1 y43@1 y53@1;\n    \n            ! Add covariances between all RIs\n            RIX1-RIY3 WITH RIX1-RIY3;\n \n            !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\n            ! WITHIN PART: MEASUREMENT MODEL !\n            !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\n\n            ! Due to having a random intercept per indicator, the measurement model \n            ! is only on the within part of the measurements\n\n            ! Factor models for X at 5 waves (constrained)\n            WFX1 BY x11-x13 (a b c);\n            WFX2 BY x21-x23 (a b c);\n            WFX3 BY x31-x33 (a b c);\n            WFX4 BY x41-x43 (a b c); \n            WFX5 BY x51-x53 (a b c);   \n        \n            ! Factor models for Y at 5 waves (constrained)\n            WFY1 BY y11-y13 (d e f);\n            WFY2 BY y21-y23 (d e f);\n            WFY3 BY y31-y33 (d e f);\n            WFY4 BY y41-y43 (d e f);\n            WFY5 BY y51-y53 (d e f);\n    \n            ! Constrained intercepts over time (necessary for strong factorial \n            ! invariance; without these constraints we have weak factorial invariance)\n            [x11 x12 x13] (g h i);\n            [x21 x22 x23] (g h i);\n            [x31 x32 x33] (g h i);\n            [x41 x42 x43] (g h i);\n            [x51 x52 x53] (g h i);\n                \n            [y11 y12 y13] (j k l);\n            [y21 y22 y23] (j k l);\n            [y31 y32 y33] (j k l);\n            [y41 y42 y43] (j k l);\n            [y51 y52 y53] (j k l);\n        \n            ! Free latent means from second wave onward (only do this in combination \n            ! with constraints on intercepts; without these, this is not identified)\n            [WFX2* WFX3* WFX4* WFX5*];\n            [WFY2* WFY3* WFY4* WFY5*];\n    \n            !!!!!!!!!!!!!!!!!!!!!!!!!\n            ! WITHIN PART: DYNAMICS !\n            !!!!!!!!!!!!!!!!!!!!!!!!!\n  \n            ! Specify lagged effects between within-person centered latent variables\n            WFX2 WFY2 ON WFX1 WFY1;\n            WFX3 WFY3 ON WFX2 WFY2;\n            WFX4 WFY4 ON WFX3 WFY3;\n            WFX5 WFY5 ON WFX4 WFY4;\n\n            ! Estimate correlations within same wave\n            WFX1 WITH WFY1;\n            WFX2 WITH WFY2;\n            WFX3 WITH WFY3; \n            WFX4 WITH WFY4;\n            WFX5 WITH WFY5; \n\nOUTPUT:     TECH1 STDYX SAMPSTAT CINTERVAL;\n\n\nTITLE:      Multiple indicator RI-CLPM, 5 waves with 3 indicators for each \n            variable at each wave (30 observed variables). Fitting a model \n            with constraints to ensure strong factorial invariance, with a\n            random intercept for each indicator separately, for which a \n            factor model is specified, with factor loadings equal to the \n            within- person factor loadings. \n    \nDATA:       FILE = RICLPM-MI.dat;\n                \nVARIABLE:   NAMES = x11 x12 x13 x21 x22 x23 x31 x32 x33 \n                    x41 x42 x43 x51 x52 x53 y11 y12 y13 \n                    y21 y22 y23 y31 y32 y33 y41 y42 y43 \n                    y51 y52 y53;\n  \nANALYSIS:   MODEL = NOCOV; ! Sets all default covariances to zero\n  \nMODEL:      !!!!!!!!!!!!!!!!    \n            ! BETWEEN PART !\n            !!!!!!!!!!!!!!!!\n\n            ! Create between factors (random intercepts) for each indicator separately\n            RIX1 BY x11@1 x21@1 x31@1 x41@1 x51@1;\n            RIX2 BY x12@1 x22@1 x32@1 x42@1 x52@1;\n            RIX3 BY x13@1 x23@1 x33@1 x43@1 x53@1;\n            \n            RIY1 BY y11@1 y21@1 y31@1 y41@1 y51@1;\n            RIY2 BY y12@1 y22@1 y32@1 y42@1 y52@1;\n            RIY3 BY y13@1 y23@1 y33@1 y43@1 y53@1;\n    \n            ! Create single random intercept for all X-variables, and another for all \n            ! Y-variables. Constrain factor loading to be identical to within-person \n            ! factor loadings\n            RIX BY RIX1 RIX2 RIX3 (a b c);\n            RIY BY RIY1 RIY2 RIY3 (d e f);\n        \n            ! Add covariance between 2nd-order random intercepts\n            RIX WITH RIY;\n        \n            ! Constrain measurement error variances of 2nd-order factor model to 0\n            RIX1-RIY3@0; \n \n            !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\n            ! WITHIN PART: MEASUREMENT MODEL !\n            !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\n  \n            ! Due to having a random intercept per indicator, the measurement model \n            ! is only on the within part of the measurements\n\n            ! Factor models for X at 5 waves\n            WFX1 BY x11-x13 (a b c);\n            WFX2 BY x21-x23 (a b c);\n            WFX3 BY x31-x33 (a b c);\n            WFX4 BY x41-x43 (a b c); \n            WFX5 BY x51-x53 (a b c);   \n        \n            ! Factor models for Y at 5 waves\n            WFY1 BY y11-y13 (d e f);\n            WFY2 BY y21-y23 (d e f);\n            WFY3 BY y31-y33 (d e f);\n            WFY4 BY y41-y43 (d e f);\n            WFY5 BY y51-y53 (d e f);\n\n            ! Constrained intercepts over time (necessary for strong factorial invariance; \n            ! without these we have weak factorial invariance)\n            [x11 x12 x13] (g h i);\n            [x21 x22 x23] (g h i);\n            [x31 x32 x33] (g h i);\n            [x41 x42 x43] (g h i);\n            [x51 x52 x53] (g h i);\n                  \n            [y11 y12 y13] (j k l);\n            [y21 y22 y23] (j k l);\n            [y31 y32 y33] (j k l);\n            [y41 y42 y43] (j k l);\n            [y51 y52 y53] (j k l);\n    \n            ! Free latent means from second wave onward (only do this in combination with \n            ! constraints on intercepts; without these, this is not identified)\n            [WFX2* WFX3* WFX4* WFX5*];\n            [WFY2* WFY3* WFY4* WFY5*];\n    \n            !!!!!!!!!!!!!!!!!!!!!!!!!\n            ! WITHIN PART: DYNAMICS !\n            !!!!!!!!!!!!!!!!!!!!!!!!!\n\n            ! Specify lagged effects between within-person centered latent variables\n            WFX2 WFY2 ON WFX1 WFY1;\n            WFX3 WFY3 ON WFX2 WFY2;\n            WFX4 WFY4 ON WFX3 WFY3;\n            WFX5 WFY5 ON WFX4 WFY4;\n\n            ! Estimate correlations within same wave\n            WFX1 WITH WFY1;\n            WFX2 WITH WFY2;\n            WFX3 WITH WFY3; \n            WFX4 WITH WFY4;\n            WFX5 WITH WFY5; \n\nOUTPUT:     TECH1 STDYX SAMPSTAT CINTERVAL;\n\n\nWe have to overrule the default of Mplus to include a term for measurement error when the BY statement is used, through FX1@0 FX2@0 ...;. The two random intercepts are allowed to be freely correlated with each other, through RIX WITH RIY;.\nTITLE:      Multiple indicator RI-CLPM, 5 waves with 3 indicators for each \n            variable at each wave (30 observed variables). Fitting a model \n            with constraints to ensure strong factorial invariance, with \n            the RI-CLPM at the latent level.\n    \nDATA:       FILE = RICLPM-MI.dat;\n            \nVARIABLE:   NAMES = x11 x12 x13 x21 x22 x23 x31 x32 x33 \n                    x41 x42 x43 x51 x52 x53 y11 y12 y13 \n                    y21 y22 y23 y31 y32 y33 y41 y42 y43 \n                    y51 y52 y53;\n    \nANALYSIS:   MODEL = NOCOV; ! Sets all default covariances to zero\n  \nMODEL:      !!!!!!!!!!!!!!!!!!!!!\n            ! MEASUREMENT MODEL !\n            !!!!!!!!!!!!!!!!!!!!!\n    \n            ! Factor models for X at 5 waves \n            FX1 BY x11-x13 (a b c);\n            FX2 BY x21-x23 (a b c);\n            FX3 BY x31-x33 (a b c);\n            FX4 BY x41-x43 (a b c); \n            FX5 BY x51-x53 (a b c);   \n            \n            ! Factor models for Y at 5 waves\n            FY1 BY y11-y13 (d e f);\n            FY2 BY y21-y23 (d e f);\n            FY3 BY y31-y33 (d e f);\n            FY4 BY y41-y43 (d e f);\n            FY5 BY y51-y53 (d e f);\n        \n            ! Constrained intercepts over time (necessary for strong factorial \n            ! invariance; without these we have weak factorial invariance)\n            [x11 x12 x13] (g h i);\n            [x21 x22 x23] (g h i);\n            [x31 x32 x33] (g h i);\n            [x41 x42 x43] (g h i);\n            [x51 x52 x53] (g h i);\n                    \n            [y11 y12 y13] (j k l);\n            [y21 y22 y23] (j k l);\n            [y31 y32 y33] (j k l);\n            [y41 y42 y43] (j k l);\n            [y51 y52 y53] (j k l);        \n    \n            ! Free latent means from 2nd wave onward (only do this in combination with \n            ! constraints on intercepts; without these, this is not identified)\n            [FX2* FX3* FX4* FX5*];\n            [FY2* FY3* FY4* FY5*];\n      \n            !!!!!!!!!!!!!!!!    \n            ! BETWEEN PART !\n            !!!!!!!!!!!!!!!!\n    \n            ! Create between factors (random intercepts)\n            RIX BY FX1@1 FX2@1 FX3@1 FX4@1 FX5@1;\n            RIY BY FY1@1 FY2@1 FY3@1 FY4@1 FY5@1;\n    \n            ! Include covariance between random intercepts\n            RIX WITH RIY;\n  \n            ! Set residual variances of all FX and FY variables to 0 \n            FX1-FY5@0;\n    \n            !!!!!!!!!!!!!!!\n            ! WITHIN PART !\n            !!!!!!!!!!!!!!!\n    \n            ! Create within-part\n            WFX1 BY FX1@1;\n            WFX2 BY FX2@1;\n            WFX3 BY FX3@1;\n            WFX4 BY FX4@1;\n            WFX5 BY FX5@1;\n                 \n            WFY1 BY FY1@1;\n            WFY2 BY FY2@1;\n            WFY3 BY FY3@1;\n            WFY4 BY FY4@1;\n            WFY5 BY FY5@1;\n        \n            ! Specify lagged effects between within-person centered latent variables\n            WFX2 WFY2 ON WFX1 WFY1;\n            WFX3 WFY3 ON WFX2 WFY2;\n            WFX4 WFY4 ON WFX3 WFY3;\n            WFX5 WFY5 ON WFX4 WFY4;\n      \n            ! Estimate correlations within same wave\n            WFX1 WITH WFY1;\n            WFX2 WITH WFY2;\n            WFX3 WITH WFY3; \n            WFX4 WITH WFY4;\n            WFX5 WITH WFY5;\n\nOUTPUT:     TECH1 STDYX SAMPSTAT CINTERVAL;\n\n\n\n\n\nResidual syntax\nThe basic RI-CLPM model syntax (with and without constraints) can be made considerably simpler by using the ^-notation and PON and PWITH statements (pairwise ON and WITH, respectively):\n\n^-notation: By including a ^ after a variable (e.g., x1^ or y3^) a residual latent variable is automatically created for that variable with the loading parameter fixed to 1. Moreover, this notation fixes the measurement error variance of the observed variable to 0, such that, in an RI-CLPM context, x1^ and y3^ can be interpreted as deviations from a person-specific mean. This notation is available from Mplus version 8.7 onward.\nPON and PWITH: These statements define pairwise regression and correlational relationships, respectively. For example, the x1^-x5^ PWITH y1^-y5^; statement in the RI-CLPM model syntax below, defines a covariance between the within-components at the first wave, a residual covariance between the within-components at the second wave, a residual covariance between the within-components at the third wave, etc.\n\n\nThe basic modelConstraints over time\n\n\nTITLE:      The basic RI-CLPM (5 waves), using residual-language of Mplus.\n     \nDATA:       FILE = RICLPM.dat;\n                \nVARIABLE:   NAMES = x1-x5 y1-y5;\n            \nANALYSIS:   MODEL = NOCOV; ! Sets all default covariances to zero\n        \nMODEL:      ! Create between-components (random intercepts)\n            RIx BY x1-x5@1;\n            RIy BY y1-y5@1;\n    \n            ! Estimate covariance between random intercepts\n            RIx WITH RIy;\n        \n            ! Using residual-language (\"^\"-notation) Mplus automatically creates \n            ! within-person centered variables with measurement error variances \n            ! constrained at 0\n\n            ! Estimate lagged effects between within-person centered variables using \n            ! \"Pairwise ON\"-notation.\n            x2^-x5^ y2^-y5^ PON x1^-x4^ y1^-y4^; ! Autoregressive effects\n            x2^-x5^ y2^-y5^ PON y1^-y4^ x1^-x4^; ! Cross-lagged effects\n    \n            ! Estimate covariance between within-person components using \n            ! \"Pairwise WITH\"-notation\n            x1^-x5^ PWITH y1^-y5^;\n                \nOUTPUT:     TECH1 STDYX SAMPSTAT CINTERVAL;\n\n\nTITLE:      The basic RI-CLPM (5 waves), using residual-language of Mplus.\n            Constrain the grand means, (residual) variances, and lagged effects \n            over time.   \n       \nDATA:       FILE = RICLPM.dat;\n                    \nVARIABLE:   NAMES = x1-x5 y1-y5;\n            \nANALYSIS:   MODEL = NOCOV; ! Sets all default covariances to zero\n        \nMODEL:      ! Create between-components (random intercepts)\n            RIx BY x1-x5@1;\n            RIy BY y1-y5@1;\n    \n            ! Estimate covariance between the random intercepts\n            RIx WITH RIy;\n        \n            ! Estimate lagged effects between within-person centered variables using\n            ! \"pairwise ON\"-notation.\n            x2^-x5^ PON x1^-x4^ (a); ! Autoregressive effects (contrained)\n            y2^-y5^ PON y1^-y4^ (b); \n            x2^-x5^ PON y1^-y4^ (c); ! Cross-lagged effects (constrained)\n            y2^-y5^ PON x1^-x4^ (d);\n      \n            ! Estimate (residual) (co)variance between within-person components using \n            ! \"pairwise WITH\"-notation\n            x1^ WITH y1^; ! Covariance\n            x2^-x5^ PWITH y2^-y5^ (cov); ! Residual covariances\n            x2^-x5^ (vx); ! Residual variance x^\n            y2^-y5^ (vy); ! Residual variance y^\n\n            ! Constrain grand means to be invariant over time\n            [x1 x2 x3 x4 x5] (mx);\n            [y1 y2 y3 y4 y5] (my);\n                \nOUTPUT:     TECH1 STDYX SAMPSTAT CINTERVAL;\n\n\n\n\n\n\n\n\nReferences\n\nAsparouhov, Tihomir, and Bengt O. Muthén. 2021. “Residual structural equation models.”\n\n\nMeredith, William. 1993. “Measurement invariance, factor analysis and factorial invariance.” Psychometrika. https://doi.org/10.1007/BF02294825.\n\n\nMuthén, L. K., and B. O. Muthén. 2017. Mplus User’s Guide. Eighth Edition. Los Angeles, CA: Muthén & Muthén."
  },
  {
    "objectID": "news.html",
    "href": "news.html",
    "title": "News",
    "section": "",
    "text": "This page documents important updates and additions to the Mplus syntax, lavaan code, or the FAQ.\n\n\n\nJanuary 16, 2024\nThe FAQ about inclusion of covariates in the RI-CLPM has been updated. The lavaan tab now contains additional explanation about informative hypothesis testing using the GORICA.\n\n\nJuly 6, 2023\nThe FAQ has been updated with information on investgating moderation with the RI-CLPM.\n\n\nJuly 21, 2022\nThe FAQ has been updated with information on how to impose constraints such that the standardized lagged effects can be made time-invariant. Mplus and lavaan model syntax for specifying such a model have been added as well.\n\n\nJune 28, 2022\nThe answer to the FAQ regarding an RI-CLPM for three or more outcomes has been updated with new examples of researchers applying a trivariate RI-CLPM.\n\n\nMay 17, 2022\nThe FAQ has been updated with a link to the powRICLPM R-package. This package is currently developed to allow for user-friendly power analysis for the RI-CLPM.\n\n\nNovember 23, 2021\nResidual model syntax specifications for Mplus have been added, in which the new “hat-notation” of Mplus version 8.7 is used, as well as PON and PWITH statements to allow for simpler input files. Furthermore, the FAQ was updated with the latest information on the RI-CLPM for categorical variables, and a new question and answer concerning development over time in the RI-CLPM was added.\n\n\nJuly 7, 2021\nThe FAQ has been updated with an informal response to some of the conclusions drawn by Orth et al. (2021) regarding the use and appropriateness of the CLPM and RI-CLPM."
  }
]